<html>
<head>
<title>|^Rental Rate Table^|</title>
<!-- 
Template path : Setup\RentalRateTable.htm111
Author :Ranjit
Purpose :
Referred Program : 
Folder No. :42
  Page No. :1125

-->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;"  charset="UTF-8">
<LINK rel="stylesheet" type="text/css" href="/EngDev/GenScripts94/Def.css">
<!--<LINK rel="stylesheet" type="text/css" href="/EngDev/GenScripts94/Rentpro.css">-->
<script src="/EngDev/GenScripts94/jQuerycontextMenu/jquery-1.8.2.min.js" type="text/javascript"></script>
<script language="javascript" src="/EngDev/GenScripts94/GenFunctions.js"></script>
<script language="JavaScript" src="/EngDev/GenScripts94/calendar.js"></script>
<script type="text/javascript" src="/EngDev/GenScripts94/tool_tip.js"></script>
<script language="JavaScript" src="/EngDev/GenScripts94/DomTable.js"></script>
<script language="JavaScript" src="/EngDev/GenScripts94/DateFunctions.js"></script>
<script language="JavaScript" src="/EngDev/GenScripts94/jQuerycontextMenu/jquery-1.8.2.min.js"></script>
<style type="text/css">
<!--
div.TabView div.Tabs
{
  height: 26px;
  overflow: hidden;
}
div.TabView div.Tabs a
{
 background: url('/EngDev/Images94/QuickAccess/tab_unselected.jpg');
  float: left;
  width:  150;
  Height:  26px;
  padding-top: 4px;
 color: white;
 font-weight: bold;
 text-align: center;
 vertical-align : text-bottom;
 font:10px arial,helvetica,clean,sans-serif;font-size:small;font:x-small;
 font-family:arial,helvetica,clean,sans-serif ;
 font-weight:bolder;
 text-align: center;
 font:12px;
 background-repeat:no-repeat;
}
div.TabView div.Tabs  a:hover, div.TabView div.Tabs  a.Active
{
 /*EngDev/Images94/QuickAccess/nav_on_bg.jpg  /EngDev/Images94/Dashboard/tab_header.jpg*/
 background: url('/EngDev/Images94/QuickAccess/tab_selected.jpg');
 text-decoration:underline;
 color :white;
 font-family:arial,helvetica,clean,sans-serif ;
 font-weight:bolder;
 text-align: center;
 vertical-align : text-bottom;
 font:12px;
 background-repeat:no-repeat;
}
div.TabView div.Pages
{
  clear: both;
 /* border: none;
  border-top:0;*/
  overflow: hidden;
   background-color:#efefef;
	/* border: 2px rgb(130,151,196) solid;*/
	 	 border-top:0;
}
div.TabView div.Pages div.Page
{
  height: 100%;
  padding: 0px;
  overflow: hidden;
}
div.TabView div.Pages div.Page div.Pad
{
  padding: 3px 5px;
}
.cursorclass
{
 cursor:hand;
 font-family: Arial, Helvetica, sans-serif;
 font-size: 9pt
 color:	#003399;
 text-decoration: underline;
}
.xstooltip
{
 	visibility: hidden;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 2;
    font: normal 8pt sans-serif;
    padding: 3px;
    border: solid 1px;
    background-repeat: repeat;
    background-image: url(images/blue.png);
		background-color:#dededc;
}
   -->
</style>
<script language="JavaScript" type="text/javascript">
var Folder_No =42;
var Page_No=1125;
var MethodCode_arr=new Array();
var	MethodText_arr=new Array();
	<!$MGIF_ExtrasExist>
	<!$MGREPEAT>
	MethodCode_arr[<!$MG_counter1>]="<!$MG_MethodCode1>";
	MethodText_arr[<!$MG_counter1>]="<!$MG_Methodext1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>
var CountryCode_arr=new Array();
var	CountryText_arr=new Array();
	<!$MGIF_CountryExist>
	<!$MGREPEAT>
	CountryCode_arr[<!$MG_counter11>]="<!$MG_CountryCode1>";
	CountryText_arr[<!$MG_counter11>]="<!$MG_Countrytext1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>
var AirlineCode_arr=new Array();
var	AirlineText_arr=new Array();
	<!$MGIF_AirlineExist>
	<!$MGREPEAT>
	AirlineCode_arr[<!$MG_counterAir>]="<!$MG_AirlineCode1>";
	AirlineText_arr[<!$MG_counterAir>]="<!$MG_AirlineText1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>
var ChequeCode_arr=new Array();
var	ChequeText_arr=new Array();
	<!$MGIF_ChequeExist>
	<!$MGREPEAT>
	ChequeCode_arr[<!$MG_counter2>]="<!$MG_ChequeCode1>";
	ChequeText_arr[<!$MG_counter2>]="<!$MG_ChequeText1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>
var CCCode_arr=new Array();
var	CCText_arr=new Array();
	<!$MGIF_CCExist>
	<!$MGREPEAT>
	CCCode_arr[<!$MG_counter3>]="<!$MG_CCCode1>";
	CCText_arr[<!$MG_counter3>]="<!$MG_CCtext1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>	
var GroupCode_arr=new Array();
var	GroupText_arr=new Array();
	<!$MGIF_GroupExist>
	<!$MGREPEAT>
	GroupCode_arr[<!$MG_counter4>]="<!$MG_GroupText_arr>";
	GroupText_arr[<!$MG_counter4>]="<!$MG_GroupText_arr>";
	<!$MGENDREPEAT>
	<!$MGENDIF>	
var PackageCode_arr=new Array();
var	PackageText_arr=new Array();
var	PackageDays_arr=new Array();
var	PackageHour_arr=new Array();
var	PackageMin_arr=new Array();
var	PackageOpt_arr=new Array();
	<!$MGIF_PackageExist>
	<!$MGREPEAT>
	PackageCode_arr[<!$MG_counter6>]="<!$MG_PackageCode_arr>";
	PackageText_arr[<!$MG_counter6>]="<!$MG_PackageText_arr>";
	PackageDays_arr[<!$MG_counter6>]="<!$MG_PackageDays_arr>";
	PackageHour_arr[<!$MG_counter6>]="<!$MG_PackageHour_arr>";
	PackageMin_arr[<!$MG_counter6>]="<!$MG_PackageMin_arr>";
	
	<!$MGENDREPEAT>
	<!$MGENDIF>			
var ExtrasCode_arr=new Array();
var	ExtrasText_arr=new Array();
	<!$MGIF_ExtrasExist>
	<!$MGREPEAT>
	ExtrasCode_arr[<!$MG_counter7>]="<!$MG_ExtrasCode_arr>";
	ExtrasText_arr[<!$MG_counter7>]="<!$MG_ExtrasText_arr>";
	<!$MGENDREPEAT>
	<!$MGENDIF>			
var InsuCode_arr=new Array();
var	InsuText_arr=new Array();
	<!$MGIF_InsuExist1>
	<!$MGREPEAT>
	InsuCode_arr[<!$MG_counter81>]="<!$MG_InsuCode_arr1>";
	InsuText_arr[<!$MG_counter81>]="<!$MG_InsuText_arr1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>			
var FFMCode_arr=new Array();
var	FFMText_arr=new Array();
	<!$MGIF_FFMExist1>
	<!$MGREPEAT>
	FFMCode_arr[<!$MG_counter91>]="<!$MG_FFMCode_arr1>";
	FFMText_arr[<!$MG_counter91>]="<!$MG_FFMText_arr1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>			

var InsuCodeNew_arr=new Array();
var	InsuTextNew_arr=new Array();
	<!$MGIF_InsuExistNew1>
	<!$MGREPEAT>
	InsuCodeNew_arr[<!$MG_counternewins>]="<!$MG_InsuCodeNew_arr1>";
	InsuTextNew_arr[<!$MG_counternewins>]="<!$MG_InsuTextNew_arr1>";
	<!$MGENDREPEAT>
	<!$MGENDIF>	

	
function show_RateLogic_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_KmDetail_Win',0,0,evt1);
        document.getElementById('Zoom_KmDetail_Win').focus();
		DisplayRateLogicXml();
		FlightInfo();
		AdvanceReservationDays.focus();
	}
}
function show_Extras_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_KmDetail_Win');	
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_Extras_Win',0,0,evt1);
        document.getElementById('Zoom_Extras_Win').focus();
		DisplayExtrasXml();
	}
}
var NewRowCreated=0;
var NewRowCreatedId=0;
var NewrowObj,NewTbl;
function show_Insu_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_KmDetail_Win');
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		HideToolTipWindow('Zoom_Extras_Win');
		xstooltip_show(document.getElementById('AddSec2'),'Zoom_Insu_Win',50,80,evt1);
        document.getElementById('Zoom_Insu_Win').focus();
		DisplayInsuXml();
	}
}
function show_CopyGroup_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_KmDetail_Win');
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		buildMethodcombo(CopyToGroup,GroupCode_arr,GroupText_arr,0);
		var SelectedCopyGroup = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
		CopyFromGroup.value=SelectedCopyGroup.getAttribute('Group');
		if(CopyFromGroup.value!=""){
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_CopyGroup_Win',0,0,evt1);
        document.getElementById('Zoom_CopyGroup_Win').focus();
		CopyToGroup.focus();
		}else{
		alert("|^Please select row to Copy.^|")
		return false;
		}
	}
}
function show_Suppli_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		HideToolTipWindow('Zoom_KmDetail_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_Suppli_Win',0,0,evt1);
        document.getElementById('Zoom_Suppli_Win').focus();
		DisplaySuppliXml();
	}
}
function show_Billing_Zoom(evt1){
	with(document.forms[0]){
	if(ClickMenuID.value!='V'){
		CreateAutoBillingXml();
	}	
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		HideToolTipWindow('Zoom_KmDetail_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		var grpObj12Check=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
		if(parseInt(grpObj12Check.getAttribute('PDays'))>=parseInt(MinDayForSLDef.value)){	
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_Billing_Win',0,0,evt1);
        document.getElementById('Zoom_Billing_Win').focus();
		DisplayBillingXml();
		}
		else{
			alert("|^Incorrect Package Days for Billing.Min Days For SL is^| "+MinDayForSLDef.value);
		}
	}
}
function show_FFMileage_Zoom(evt1){
	with(document.forms[0]){
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_KmDetail_Win');
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_CopyGroup_Win');
		xstooltip_show(document.getElementById('KmDetLink'),'Zoom_FFMileage_Win',0,0,evt1);
        document.getElementById('Zoom_FFMileage_Win').focus();
		DisplayFFMXml();	
	}
}
function HideToolTipWindow(WinId){
	xstooltip_hide(WinId);
}		
function DisableView(){
	for (i = 0; i < document.forms[0].length; i++) 
	{
		var formElement = document.forms[0].elements[i];
		if(formElement.type=='select-one'){
			formElement.disabled=true;
		}
		if(formElement.type=='checkbox'){
			formElement.disabled=true;
		}
		if(formElement.type=='text'){
			formElement.disabled=true;
		}
		if(formElement.type=='button' && (formElement.id != 'Hist_BT' && formElement.id != 'CopyGr_BT' && formElement.id != 'FFMileage_BT' && formElement.id != 'Billing_BT' && formElement.id != 'Insur_BT' && formElement.id != 'Extras_BT' && formElement.id != 'Suppli_BT' && formElement.id != 'OutBrBtn' && formElement.id != 'InBrBtn' && formElement.id != 'PaymentBtn' && formElement.id != 'CountryReq' && formElement.id != 'CountryExc' && formElement.id != 'SuppliLogic' && formElement.id != 'TourBtn' && formElement.id != 'FlightBtn' && formElement.id != 'FFMileageProceed' && formElement.id != 'BillingProceed' && formElement.id != 'CopyProceed' && formElement.id != 'SUppliProceed' && formElement.id != 'InsuProceed' && formElement.id != 'SplitProceed' && formElement.id != 'RateLogic' && formElement.id != 'RateLogicProceed')){
			formElement.style.display="None";
		}	
		if(formElement.type=='password'){
			formElement.disabled=true;
		}	
		if(formElement.type=='reset'){
			formElement.style.display="None";
		}			
	}
}

function Cursor(){
	with(document.forms[0]){
	fullscreen();
		LoadDefaultXml();
		EnableDisableBt(true);
		HideToolTipWindow('Zoom_KmDetail_Win')
			DeleteBtn.style.display="None";
			if(parseInt(CompanyFormat.value)==123)
			{
				document.getElementById('ShowOptimizeByDay').style.display='';
				document.getElementById('WorkHourLogicId').style.display='';
			}
			if(parseInt(CompanyFormat.value)==144)
			{
			document.getElementById('ShowOptimizeByDay').style.display='';
				document.getElementById('OptPkg1').style.display='';
				document.getElementById('OptPkg2').style.display='';
			}
			if(parseInt(CompanyFormat.value)==156)
			{
				document.getElementById('ShowOMonthlyRental').style.display='';
			}
			if(parseInt(CompanyFormat.value)==142)
			{
				document.getElementById('CopyProceed').style.display='none';
			}
				if(ClickMenuID.value=='V'){
				Proceed_BT.style.display='none';
				CopyGr_BT.disabled=true;
				AddSec2.style.display='none';
				RateLogicProceed.style.display='none';
				InsuProceed.style.display='none';
				BillingProceed.style.display='none';
				FFMileageProceed.style.display='none';
				SplitProceed.style.display='none';
				SUppliProceed.style.display='none';
				CopyExtrProceed.style.display='none';
				CopyInsuProceed.style.display='none';
				FFMAdd.style.display='none';
				BillAdd.style.display='none';
				AddInsu.style.display='none';
				AddExt.style.display='none';
				AddSup.style.display='none';
				AddTour.style.display='none';
				}
				
		if( ClickMenuID.value=='D'){
			Proceed_BT.style.display='none';
			AddSec2.style.display='none';
			AddPay.style.display='none';
			AddExt.style.display='none';
			AddSup.style.display='none';
			BillAdd.style.display='none';
			document.getElementById('C3').style.display='none';
			CopyGr_BT.disabled=true;
			DisableView();
			disableAll();
			Exit.style.display="";
			if(parseInt(CompanyFormat.value)==126)
			{
			document.getElementById('MainHeaderid').style.display="none";
			document.getElementById('fororix').style.display="";
			Print_BT.disabled=false;
						
			}
			
			
			if(ClickMenuID.value=='D')
			{
				DeleteBtn.style.display="";
				DeleteBtn.disabled=false;
			}
			
			
		}
		
		if(AllowCarShare.value=='Y')
			{
			//alert(11);
			document.getElementById('Mins').style.display="";
			for(i=1;i<=Sec2Count.value;i++)
			{
			document.getElementById('Min'+i).style.display="";
			
			}
			}
			
		//alert(Sec2Count.value)
		if(Sec2Count.value>11 && ClickMenuID.value=='M')
			{
			document.getElementById('Scroll').style.display='';
			}
			if(Sec2Count.value>15 && ClickMenuID.value=='V')
			{
			document.getElementById('Scroll').style.display='';
			}
		if(ClickMenuID.value!="C"){
		RateNo.className="readOnly_textInputFieldNr";
		RateNo.readOnly=true;
		document.getElementById('C2').style.display="none";
		FromDate.disabled=true;
		RateCurr.disabled=true;
		}
		if(ClickMenuID.value!='V')
		RateName.focus();
		
		if(DeactiveDate.value !='' )
		DeactiveDate.className="readOnly_textInputFieldNr";
		if(document.forms[0].DeactiveDate && document.forms[0].DeactiveDate.value!=''&& ClickMenuID.value=='M' && (parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116))
			{
				document.getElementById('AddSec2').style.display="none";
			}
			
			if(parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116)
			{
			document.getElementById('RateLog').style.display="";
			}
	
			if(parseInt(CompanyFormat.value)==142 && trim(RateName.value)=="")
			{
				
				TariffClass.value='1';
			}
			
	if(CompanyFormat.value >= 145 && CompanyFormat.value <= 152){
		document.getElementById("CustomerDaysLogicId").style.display = "none";
		document.getElementById("FixedExgRateLblId").style.display = "none";
		document.getElementById("FixedExgRateFldId").style.display = "none";
	}	
		
          if(parseInt(CompanyFormat.value)==158)
			{
				document.getElementById('SalesMan_158').style.display='';
				
			}
          else		
           {
		        document.getElementById('SalesMan_158').style.display="none";
		    }		  
	}
}
var globalXML;	
function LoadDefaultXml(){
	with(document.forms[0]){
			var urlOc = '[X]GetRentalRateXML&Arguments=-A'+RateNo.value+',-A'+RateCurr.value+',-A'+FromDate.value+',-A,-A'+ClickMenuID.value;
			globalXML = loadDefXml(urlOc);
		
			var XmlRoot = globalXML.getElementsByTagName("Logic").item(0);
			RateName.value=XmlRoot.getAttribute('RateName');
			RateCurr.value=XmlRoot.getAttribute('RateCurr');
			FromDate.value=XmlRoot.getAttribute('FromDate');
			ToDate.value=XmlRoot.getAttribute('ToDate');
			TariffClass.value=XmlRoot.getAttribute('Class');
			InternationalCode.value=XmlRoot.getAttribute('InternationCode');
			RefDrvExt.value=XmlRoot.getAttribute('ReferDrvExt');
			Sec2Count.value=XmlRoot.getAttribute('Sec2Count');
			//LoadRateSection2();	
			//DisplayPaymentXml();
			DisplayOutBranchXml('OutBranch',document.getElementById('CheckOutBranch'));
		DisplayOutBranchXml('InBranch',document.getElementById('CheckInBranch'));
		ShowPaymentRequirment(false);
		DisplayTourOperatorXml();
		DisplayCountryReqXml();
		DisplayCountryExcXml();
		DisplayFlightXml();
		DisplayPaymentXml();
		
	}
}
function UpdateRateSec1(){
	with(document.forms[0]){
			var XmlRoot = globalXML.getElementsByTagName("Logic").item(0);
			XmlRoot.setAttribute('RateName',RateName.value);
			XmlRoot.setAttribute('RateNo',RateNo.value);
			XmlRoot.setAttribute('RateCurr',RateCurr.value);			
			XmlRoot.setAttribute('FromDate',FromDate.value);
			XmlRoot.setAttribute('ToDate',ToDate.value);
			XmlRoot.setAttribute('InternationCode',InternationalCode.value);
			XmlRoot.setAttribute('ReferDrvExt',RefDrvExt.value);
			XmlRoot.setAttribute('Class',TariffClass.value);
			XmlRoot.setAttribute('Status',ClickMenuID.value);
	}
}
function LoadRateSection2(){
	with(document.forms[0]){
	details1=globalXML.getElementsByTagName('Section2').item(0);
	//alert(globalXML.xml);
	//Node=globalXML.selectNodes("//Record");
	Node=globalXML.getElementsByTagName('Record');
        if(details1)
        {
            var cnt=Node.length;
			
	        for(var i=0;i<cnt;i++)
            {
				details=globalXML.getElementsByTagName('Record').item(i);			
				var SrNo1=parseInt(details.getAttribute('SrNo'));
				if(!details.getAttribute('SrNo'))
					SrNo1=0;
					
				CreateRateTableRow(SrNo1,details.getAttribute('RateSrNO'),details.getAttribute('Group'),details.getAttribute('Package'),details.getAttribute('PDays'),details.getAttribute('PHours'),details.getAttribute('PMin'),details.getAttribute('Price'),details.getAttribute('DrvExtPrice'),details.getAttribute('CustExtPrice'),details,details.getAttribute('KMAllwPerPack'),details.getAttribute('ExtAllwPerDay'),details.getAttribute('DrvChargePerKm'),details.getAttribute('CustChargePerKm'),details.getAttribute('MaxKmToCharge'),details.getAttribute('MaxKmToChargeType'),'M');
			}
		}	
	}
}
function CallRateLogicProceed(){
	with(document.forms[0]){
		var DiscPerParam=parseInt(isNaN(parseInt(MaxDiscountPerc.value))?0:parseInt(MaxDiscountPerc.value))
		if(DiscPerParam==0 && Discountable.value=="Y"){
			alert("|^Please enter Max Discount Percent.^|");
			MaxDiscountPerc.focus();
			return false;
		}
		UpdateOutBranchXml('OutBranch',document.getElementById('CheckOutBranch'));
		UpdateOutBranchXml('InBranch',document.getElementById('CheckInBranch'));
		HideToolTipWindow('Zoom_KmDetail_Win')	
	}
}
var newatt;
var Record;
var RateLogicXmlObj;
function UpdateRateLogicXml()
{	   with(document.forms[0])
        {
           Record = getXMLElementsArray(globalXML,'Root/Logic')[0];
				Record.setAttribute('Cancellable',Cancellable.value);
				Record.setAttribute('Discountable',Discountable.value);
				Record.setAttribute('MaxDiscountPerc',MaxDiscountPerc.value);
				if(document.getElementById('Discountable').value!="Y")
				{
				document.getElementById('MaxDiscountPerc').readOnly=true;
				document.getElementById('MaxDiscountPerc').value="0.00";
				}
				else
				document.getElementById('MaxDiscountPerc').readOnly=false;
				Record.setAttribute('OptimizeAbove',OptimizeAbove.value);
				Record.setAttribute('ChargeDropOffFee',ChargeDropOffFee.value);
				Record.setAttribute('ChargeFuelTank',ChargeFuelTank.value);
				Record.setAttribute('CountryException',CountryException.value);
				Record.setAttribute('CountryRequired',CountryRequired.value);
				Record.setAttribute('FixedExchangeRate',FixedExchangeRate.value);
				Record.setAttribute('ChargeAirportFee',ChargeAirportFee.value);
				Record.setAttribute('FlightInformation',FlightInformation.value);
				
				Record.setAttribute('ThroughOtherCountry',ThroughOtherCountry.value);
				Record.setAttribute('AdvanceReservationDays',AdvanceReservationDays.value);
				Record.setAttribute('AdvanceReservationDaysTo',AdvanceReservationDaysTo.value);
				Record.setAttribute('NoOfFreeDays',FreeDays.value);
				Record.setAttribute('NoOfDays',NOofDays.value);
				Record.setAttribute('Rounding',Rounding.value);
				Record.setAttribute('ReligiousAgreement',ReligiousAgreement.value);
				Record.setAttribute('CustomerExtensionDiscount',CustomerExtensionDiscount.value);
				Record.setAttribute('CustExtDiscountPerc',CustExtDiscountPerc.value);
				Record.setAttribute('Status','M');
				Record.setAttribute('SalesMan',SalesMan.value);
			
				if(parseInt(CompanyFormat.value)==123)
				{
					Record.setAttribute('OptimizeByDay',OptimizeByDay.value);
					Record.setAttribute('AHFAmount',AHFAmount.value);
					Record.setAttribute('AHCPer',AHCPer.value);
				}
				if(parseInt(CompanyFormat.value)==144)
				{
				Record.setAttribute('OptimizeByDay',OptimizeByDay.value);
					Record.setAttribute('OptimizePackage',OptimizePackage.value);
			
				}
				if(parseInt(CompanyFormat.value)==156)
				{
				Record.setAttribute('MonthlyRental',MonthlyRental.value);			
				}
			}		
}
var SelRec;
function DisplayRateLogicXml()
{
	   with(document.forms[0])
        {
			SelRec = (getXMLElementsArray(globalXML,'Root/Logic'))[0];
					document.getElementById('AdvanceReservationDays').value=SelRec.getAttribute('AdvanceReservationDays');
					document.getElementById('AdvanceReservationDaysTo').value=SelRec.getAttribute('AdvanceReservationDaysTo');
				document.getElementById('NOofDays').value=SelRec.getAttribute('NoOfDays');
				document.getElementById('FreeDays').value=SelRec.getAttribute('NoOfFreeDays');
				document.getElementById('Rounding').value=SelRec.getAttribute('Rounding');
				document.getElementById('ThroughOtherCountry').value=SelRec.getAttribute('ThroughOtherCountry');
				document.getElementById('FlightInformation').value=SelRec.getAttribute('FlightInformation');
				document.getElementById('FixedExchangeRate').value=SelRec.getAttribute('FixedExchangeRate');
				document.getElementById('CountryRequired').value=SelRec.getAttribute('CountryRequired');
				document.getElementById('CountryException').value=SelRec.getAttribute('CountryException');
				document.getElementById('ChargeFuelTank').value=SelRec.getAttribute('ChargeFuelTank');
				document.getElementById('ChargeDropOffFee').value=SelRec.getAttribute('ChargeDropOffFee');
				document.getElementById('ChargeAirportFee').value=SelRec.getAttribute('ChargeAirportFee');
				document.getElementById('ReligiousAgreement').value=SelRec.getAttribute('ReligiousAgreement');
				document.getElementById('CustomerExtensionDiscount').value=SelRec.getAttribute('CustomerExtensionDiscount');
				document.getElementById('CustExtDiscountPerc').value=SelRec.getAttribute('CustExtDiscountPerc');
				document.getElementById('Cancellable').value=SelRec.getAttribute('Cancellable');
				document.getElementById('Discountable').value=SelRec.getAttribute('Discountable');
				document.getElementById('FreeDays').value=SelRec.getAttribute('NoOfFreeDays');
				document.getElementById('NOofDays').value=SelRec.getAttribute('NoOfDays');
			    document.getElementById('MaxDiscountPerc').value=SelRec.getAttribute('MaxDiscountPerc');
				document.getElementById('SalesMan').value=SelRec.getAttribute('SalesMan');
				if(parseInt(CompanyFormat.value)!=145 && parseInt(CompanyFormat.value)!=146 && parseInt(CompanyFormat.value)!=147 && parseInt(CompanyFormat.value)!=148 && parseInt(CompanyFormat.value)!=149 && parseInt(CompanyFormat.value)!=150 && parseInt(CompanyFormat.value)!=151 && parseInt(CompanyFormat.value)!=152)
				if(document.getElementById('ThroughOtherCountry').value=='')
					document.getElementById('ThroughOtherCountry').value='N';
				if(document.getElementById('Discountable').value!="Y")
				document.getElementById('MaxDiscountPerc').readOnly=true;
				else
				document.getElementById('MaxDiscountPerc').readOnly=false;
				document.getElementById('OptimizeAbove').value=SelRec.getAttribute('OptimizeAbove');
				if(parseInt(CompanyFormat.value)==123)
				{
					document.getElementById('OptimizeByDay').value=SelRec.getAttribute('OptimizeByDay');
					document.getElementById('AHFAmount').value=SelRec.getAttribute('AHFAmount');
					document.getElementById('AHCPer').value=SelRec.getAttribute('AHCPer');
					
				}
				if(parseInt(CompanyFormat.value)==144)
				{
					document.getElementById('OptimizePackage').value=SelRec.getAttribute('OptimizePackage');
					document.getElementById('OptimizeByDay').value=SelRec.getAttribute('OptimizeByDay');
				}
				if(parseInt(CompanyFormat.value)==156)
				{
					document.getElementById('MonthlyRental').value=SelRec.getAttribute('MonthlyRental');
				}
				if(ClickMenuID.value=="C" && (parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116))
				document.getElementById('OptimizeAbove').value="Y";
				CustDisOnCHange();
				checkAmountAndPercent('AHFAmount','AHCPer');
		}		
}
function UpdateOutBranchXml(BranchInOuTagName,BranchObject){
 with(document.forms[0]){
			var nd=(getJQXMLElementsArray(globalXML,BranchInOuTagName))[0].getElementsByTagName("Branch");
			var cout1=(getJQXMLElementsArray(globalXML,BranchInOuTagName))[0].getElementsByTagName("Branch").length;
				if(!nd) return false;		
				for(var j=0;j<cout1;j++){
				(getJQXMLElementsArray(globalXML,BranchInOuTagName))[0].removeChild(nd[j]);
				}
			grp1 = globalXML.getElementsByTagName(BranchInOuTagName).item(0);
		   for(i=0;i<BranchObject.options.length;i++)
			{
			   if(BranchObject.options[i].selected == true && BranchObject.options[i].value!='')
				{
				   Record1=createElementCommon(globalXML,globalXML,'Branch');
				   newatt=createAttributeCommon(globalXML,globalXML,'Code');
				   newatt.value=BranchObject.options[i].value;
				   Record1.setAttributeNode(newatt);
				   appendNodeToParent(grp1,Record1)
				}
			}
		}
}
var PaymentXmlObj;
function UpdatePaymentXml()
{
	with(document.forms[0])
	{
		var root=globalXML.getElementsByTagName('PaymentReq').item(0);
		if(currentPayRowId != 0)
		{
		var grpObj=(getJQXMLElementsArray(globalXML,"PaymentReq/Payment[Serial='"+currentPayRowId+"']"))[0];
        grpObj.setAttribute('Method',document.getElementById('Method'+currentPayRowId).value);
		grpObj.setAttribute('TypeCode',document.getElementById('TypeCode'+currentPayRowId).value);
		grpObj.setAttribute('Status','M');
		
		}
	}
}
function UpdateTourXml(){
	with(document.forms[0]){
		var root21=globalXML.getElementsByTagName('TourOperator').item(0);
		if(currentTourRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"TourOperator/Tour[Serial='"+currentTourRowId+"']"))[0];
        grpObj.setAttribute('TourID',document.getElementById('TourID'+currentTourRowId).value);
		}
	}
}
function UpdateCountReqXml(CountryReqRowObj,RowCOunter){
	with(document.forms[0]){
	CountryReqRowObj.onchange=function(){
		currentCountReqRowId=RowCOunter;
		var root=globalXML.getElementsByTagName('CountryReq').item(0);
		if(currentCountReqRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"CountryReq/CountReq[Serial='"+currentCountReqRowId+"']"))[0];
        grpObj.setAttribute('Code',document.getElementById('CountryReq'+currentCountReqRowId).value);
		grpObj.setAttribute('Status','M');
		}
		}
	}
}
function UpdateAirlineXml(AirlineRowObj,RowCOunter){
	with(document.forms[0]){
	AirlineRowObj.onchange=function(){
		currentAirlineRowId=RowCOunter;
		var root=globalXML.getElementsByTagName('AirlinesInfo').item(0);
		if(currentAirlineRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"AirlinesInfo/Flight[Serial='"+currentAirlineRowId+"']"))[0];
        grpObj.setAttribute('Code',document.getElementById('AirlineID'+currentAirlineRowId).value);
		grpObj.setAttribute('Status','M');
		}
		}
	}
}
function UpdateCountExcXml(CountryExcRowObj,RowCOunter1){
	with(document.forms[0]){
	CountryExcRowObj.onchange=function(){
		currentCountExcRowId =RowCOunter1;
		var root=globalXML.getElementsByTagName('CountryExc').item(0);
		if(currentCountExcRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"CountryExc/CountExc[Serial='"+currentCountExcRowId+"']"))[0];
        grpObj.setAttribute('Code',document.getElementById('CountryExc'+currentCountExcRowId).value);
		grpObj.setAttribute('Status','M');
		}
		}
	}
}
function UpdateExtrasXml(FieldObjExt,RowCounterExt,IntLimit,DecLimit){
	with(document.forms[0]){
		FieldObjExt.onchange=function(){
		if(IntLimit>0)
		if(!DecimalValidate(FieldObjExt,IntLimit,DecLimit))
		return false;
		currentExtrasRowId=RowCounterExt;
		if(currentRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Extras/Extra[Serial='"+currentExtrasRowId+"']"))[0];
        grpObj.setAttribute('Code',document.getElementById('ExtrasCode'+currentExtrasRowId).value);
		grpObj.setAttribute('Included',document.getElementById('Included'+currentExtrasRowId).value);
		grpObj.setAttribute('Price',document.getElementById('ExtrasPrice'+currentExtrasRowId).value);
		grpObj.setAttribute('Status','M');
		UpdateSec2Status();
		}
		}
	}
}
function UpdateFFMXml(FieldObjFFM,RowCounterFFM,IntLimit,DecLimit){
	with(document.forms[0]){
		FieldObjFFM.onchange=function(){
		if(IntLimit>0)
		if(!DecimalValidate(FieldObjFFM,IntLimit,DecLimit))
		return false;
		currentFFMRowId=RowCounterFFM;
		if(currentRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/FFMileage/FFM[Serial='"+currentFFMRowId+"']"))[0];
        grpObj.setAttribute('FFMCode',document.getElementById('FFMCode'+currentFFMRowId).value);
		grpObj.setAttribute('Miles',document.getElementById('Miles'+currentFFMRowId).value);
		grpObj.setAttribute('ExtMiles',document.getElementById('ExtMiles'+currentFFMRowId).value);
		grpObj.setAttribute('Status','M');
		UpdateSec2Status();
		}
		}
	}
}
function UpdateInsuXml(FieldObjExt,RowCounterExt,IntLimit,DecLimit){
	with(document.forms[0]){
		FieldObjExt.onchange=function(){
		if(IntLimit>0)
		if(!DecimalValidate(FieldObjExt,IntLimit,DecLimit))
		return false;
		currentInsuRowId=RowCounterExt;
		if(currentRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Insurances/Insu[Serial='"+currentInsuRowId+"']"))[0];
        grpObj.setAttribute('Code',document.getElementById('InsuCode'+currentInsuRowId).value);
		grpObj.setAttribute('Included',document.getElementById('Included'+currentInsuRowId).value);
		grpObj.setAttribute('Price',document.getElementById('InsuPrice'+currentInsuRowId).value);
		grpObj.setAttribute('MaxCharge',document.getElementById('MaxCharge'+currentInsuRowId).value);
		grpObj.setAttribute('MinCharge',document.getElementById('MinCharge'+currentInsuRowId).value);
		grpObj.setAttribute('DrvExt',document.getElementById('DrvExt'+currentInsuRowId).value);
		grpObj.setAttribute('CustExt',document.getElementById('CustExt'+currentInsuRowId).value);
		grpObj.setAttribute('Deduct',document.getElementById('Deduct'+currentInsuRowId).value);
		grpObj.setAttribute('NWDeduct',document.getElementById('NWDeduct'+currentInsuRowId).value);
		grpObj.setAttribute('SuppYoungDrv',document.getElementById('SuppYoungDrv'+currentInsuRowId).value);
		grpObj.setAttribute('SuppYoungDrvDeduct',document.getElementById('SuppYoungDrvDeduct'+currentInsuRowId).value);
		grpObj.setAttribute('Status','M');
		UpdateSec2Status();
		}
		}
	}
}
function UpdateSuppliXml(FieldObjSupp,RowCounterSupp,calledFromDate,IntLimit,DecLimit){
	with(document.forms[0]){
	FieldObjSupp.onchange=function(){
	if(calledFromDate==1)
	if(FieldObjSupp.value!=''){isDate(FieldObjSupp,2);}
	if(IntLimit>0)
		if(!DecimalValidate(FieldObjSupp,IntLimit,DecLimit))
		return false;
		
	currentSuppRowId=RowCounterSupp;
		if(currentRowId != 0){
		var grpObjSupp=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Suppliment/Suppli[Serial='"+currentSuppRowId+"']"))[0];
		if(compareDatesByValue(FromDate.value,document.getElementById('FromDate'+currentSuppRowId).value)){
			alert('|^Suppliment From date should be greater that Rate From Date^|  '+FromDate.value);
			document.getElementById('FromDate'+currentSuppRowId).value='';
			return false;
		}
		if(compareDatesByValue(document.getElementById('ToDate'+currentSuppRowId).value,ToDate.value)){
			alert('|^Suppliment To date should be less than Rate To Date^|  '+FromDate.value);
			document.getElementById('ToDate'+currentSuppRowId).value='';
			return false;
		}
		if(document.getElementById('FromDate'+currentSuppRowId).value!='' && document.getElementById('ToDate'+currentSuppRowId).value!='' &&compareDatesByValue(document.getElementById('FromDate'+currentSuppRowId).value,document.getElementById('ToDate'+currentSuppRowId).value)){
			alert('|^Invalid Date^|');
			document.getElementById('ToDate'+currentSuppRowId).value='';
			return false;
		}
        grpObjSupp.setAttribute('FromDate',document.getElementById('FromDate'+currentSuppRowId).value);
		grpObjSupp.setAttribute('ToDate',document.getElementById('ToDate'+currentSuppRowId).value);
		grpObjSupp.setAttribute('Price',document.getElementById('SuppliPrice'+currentSuppRowId).value);
		grpObjSupp.setAttribute('Status','M');
		UpdateSec2Status();
		}
	 }
	}
}
function UpdateBillingXml(FieldObjBill,BillRow){

	with(document.forms[0]){
	FieldObjBill.onchange=function(){
		BillingOnchangeUpdate(BillRow);
		//ValidateBillingMonth(BillRow);
   	 }
	}
}
function BillingOnchangeUpdate(BillingRowParam){
with(document.forms[0]){
	currentBillRowId=BillingRowParam;
	if(document.getElementById('BillAmount'+currentBillRowId).value==0){
	var RecSec2=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
	var RecPrice=RecSec2.getAttribute("Price");
	var RecDays=RecSec2.getAttribute("PDays");
	document.getElementById('BillAmount'+currentBillRowId).value=parseFloat(RecPrice/(RecDays/30)).toFixed(DecimalFormat.value);
	}
	var BilCOunt=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill")).length;
		if(currentBillRowId != 0){
		var grpObjSupp1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill[Serial='"+currentBillRowId+"']"))[0];
		grpObjSupp1.setAttribute('Month',document.getElementById('BillMonth'+currentBillRowId).value);
		grpObjSupp1.setAttribute('Amount',document.getElementById('BillAmount'+currentBillRowId).value);
		grpObjSupp1.setAttribute('Status','M');
		UpdateSec2Status();
		}
		}
   	 }

function ValidateBillingAmount1()
{
		with(document.forms[0]){
			
				if(parseInt(CompanyFormat.value)==82)
				{
					  HideToolTipWindow('Zoom_Billing_Win');
				}
				else
				{
					ValidateBillingAmount();
				}
		}
}
	 
function ValidateBillingAmount()
{	
	with(document.forms[0])
	{
		tbl=document.getElementById("BillingTable");
		rows=tbl.tBodies[0].rows;
		for(var n=1;n<rows.length;n++)
		{
			if(document.getElementById("BillMonth"+n))
			if(document.getElementById("BillMonth"+n).value == '' || document.getElementById("BillMonth"+n).value == 0 )
			{
				alert("Please enter Billing month");
				return false;
			}
		}
		var RecSec2=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
		var RecPrice1=RecSec2.getAttribute("Price");
		var TotalBilAmt=0;
		var BilCOunt=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill"));
		
		for(var y=0;y<BilCOunt.length;y++){
			var BillObj1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill"))[y];
			TotalBilAmt=parseFloat(TotalBilAmt)+parseFloat(BillObj1.getAttribute("Amount"));
		}
		
		if(RecPrice1>TotalBilAmt)
		alert("|^Package Price exceed Billing Amount^|");
		if(RecPrice1<TotalBilAmt)
		alert("|^Billing Amount exceed Package Price^|" );
   	    HideToolTipWindow('Zoom_Billing_Win');
	/*	if(TotalBilAmt==0 || TotalBilAmt=='')
		{
		alert("|^Please Enter Billing Amount^|")
		return false;
		}*/
	}
}
function DisplayPaymentXml(){
 with(document.forms[0]){
	
           for( j=0;j<globalXML.getElementsByTagName('Payment').length;j++)
			{
				SelRec1 = globalXML.getElementsByTagName('Payment').item(j);
				CreatePaymentTableRow(SelRec1.getAttribute('Method'),SelRec1.getAttribute('TypeCode'),0);
			}
		}
}
function DisplayExtrasXml(){
 with(document.forms[0]){
	var grpObj1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Extras/Extra"));
	var grpObj12=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
        document.getElementById('ExtrasGroup').innerHTML=document.getElementById('Group'+currentRowId).value;
		document.getElementById('ExtrasPkg').innerHTML=document.getElementById('Package'+currentRowId).value;
			tbl=document.getElementById("ExtrasTable");
			rows = tbl.rows;
			var rowsCnt = rows.length;
			for(var i=1;i<rowsCnt;i++){
				rows[1].parentNode.removeChild(rows[1]);
			}
           for( j=0;j<grpObj1.length;j++)
			{
			SelRec12 = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Extras/Extra"))[j];
			if(SelRec12.getAttribute('Status')!="D")
			CreateExtrasTableRow(SelRec12.getAttribute('Serial'),SelRec12.getAttribute('Code'),SelRec12.getAttribute('Included'),SelRec12.getAttribute('Price'),SelRec12);
			}
		}
}
function DisplayInsuXml(){
 with(document.forms[0]){
	var grpObj1=getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Insurances/Insu");
	var grpObj12=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
        document.getElementById('InsuGroup').innerHTML=document.getElementById('Group'+currentRowId).value;
		document.getElementById('InsuPkg').innerHTML=document.getElementById('Package'+currentRowId).value;
			tbl=document.getElementById("InsuTable");
			rows = tbl.rows;
			var rowsCnt = rows.length;
			for(var i=1;i<rowsCnt;i++){
				rows[1].parentNode.removeChild(rows[1]);
			}
           for( j=0;j<grpObj1.length;j++)
			{
			SelRec12 = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Insurances/Insu"))[j];
			if(SelRec12.getAttribute('Status')!="D")
			CreateInsuTableRow(SelRec12.getAttribute('Serial'),SelRec12.getAttribute('Code'),SelRec12.getAttribute('Included'),SelRec12.getAttribute('Price'),SelRec12,SelRec12.getAttribute('MaxCharge'),SelRec12.getAttribute('MinCharge'),SelRec12.getAttribute('DrvExt'),SelRec12.getAttribute('CustExt'),SelRec12.getAttribute('Deduct'),SelRec12.getAttribute('NWDeduct'),SelRec12.getAttribute('SuppYoungDrv'),SelRec12.getAttribute('SuppYoungDrvDeduct'),'Y');
			}
		}
}
function DisplaySuppliXml(){
 with(document.forms[0]){
	
	var grpObj1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Suppliment/Suppli"));
	var grpObj12=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
        document.getElementById('SuppliGroup').innerHTML=document.getElementById('Group'+currentRowId).value;
		
			tbl=document.getElementById("SuppliTable");
			rows = tbl.rows;
			var rowsCnt = rows.length;
			for(var i=1;i<rowsCnt;i++){
				rows[1].parentNode.removeChild(rows[1]);
			}
           for( j=0;j<grpObj1.length;j++)
			{
				SelRec12 = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Suppliment/Suppli"))[j];
				if(SelRec12.getAttribute('Status')!="D")
				CreateSuppliTableRow(SelRec12.getAttribute('Serial'),SelRec12.getAttribute('FromDate'),SelRec12.getAttribute('ToDate'),SelRec12.getAttribute('Price'),SelRec12);
			}
		}
}	
function CreateAutoBillingXml(){
 with(document.forms[0]){
		 if(document.getElementById('Group'+currentRowId).disabled==false && (parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116))
		 {
					tbl=document.getElementById("BillingTable");
					rows = tbl.rows;
					var rowsCnt = rows.length;
						//alert(rowsCnt)
					for(var i=1;i<rowsCnt;i++){
					var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/Billing/Bill[Serial='"+parseInt(i)+"']";
					var jd=(getJQXMLElementsArray(globalXML,tag1))[0];
					if(jd)
								{
									
									jd.parentNode.removeChild(jd);
									
								}
					}
		}
		//alert(getXMLStringFromObject(globalXML))
		
	  var grpObj12Check=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
	var BilCOunt1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill")).length;
	if(((parseInt(CompanyFormat.value)!=8 && parseInt(CompanyFormat.value)!=100 && parseInt(CompanyFormat.value)!=116) && parseInt(grpObj12Check.getAttribute('PDays'))>=parseInt(MinDayForSLDef.value) && BilCOunt1<1 && ClickMenuID.value=='C') || ((parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116) && parseInt(grpObj12Check.getAttribute('PDays'))>=parseInt(MinDayForSLDef.value) && BilCOunt1<1  )){
	var grpObj55=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
    var daysParam=grpObj55.getAttribute('PDays');
	var PriceParam=grpObj55.getAttribute('Price');

	var NoOfMonth=parseInt(parseInt(isNaN(parseInt(daysParam))?0:parseInt(daysParam))/30);
	document.getElementById('NumberOfMnth').value=NoOfMonth;
	var PricePerMonth=parseFloat(parseInt(isNaN(parseInt(PriceParam))?0:parseInt(PriceParam))/NoOfMonth).toFixed(DecimalFormat.value);
		for(m=0;m<NoOfMonth;m++){
			CreateBillingXmlNode(m+1,PricePerMonth,1);
		}
	}
	}
}	
function DisplayBillingXml(){
 with(document.forms[0]){
	
	var grpObj1=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill"));
	var grpObj12=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
    document.getElementById("BilGrp").innerHTML=grpObj12.getAttribute('Group');	
	document.getElementById("BilPck").innerHTML=grpObj12.getAttribute('Package');	
			tbl=document.getElementById("BillingTable");
			rows = tbl.rows;
			var rowsCnt = rows.length;
			for(var i=1;i<rowsCnt;i++){
				rows[1].parentNode.removeChild(rows[1]);
			}
           for( j=0;j<grpObj1.length;j++)
			{
			SelRec123 = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing/Bill"))[j];
			if(SelRec123.getAttribute('Status')!="D")
			{
				if(SelRec123.getAttribute('Serial')!=0 && (parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116))
			CreateBillingTableRow(SelRec123.getAttribute('Serial'),SelRec123.getAttribute('Month'),SelRec123.getAttribute('Amount'),SelRec123,0);
				if(parseInt(CompanyFormat.value)!=8 && parseInt(CompanyFormat.value)!=100 && parseInt(CompanyFormat.value)!=116)
			CreateBillingTableRow(SelRec123.getAttribute('Serial'),SelRec123.getAttribute('Month'),SelRec123.getAttribute('Amount'),SelRec123,0);
			}
			}
		}
}		
function DisplayFFMXml(){
 with(document.forms[0]){
	
	var grpObjffm=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/FFMileage/FFM"));
	var grpObj12=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
    document.getElementById("BilGrp").innerHTML=grpObj12.getAttribute('Group');	
	document.getElementById("BilPck").innerHTML=grpObj12.getAttribute('Package');	
			tbl=document.getElementById("FFMTable");
			rows = tbl.rows;
			var rowsCnt = rows.length;
			for(var i=1;i<rowsCnt;i++){
				rows[1].parentNode.removeChild(rows[1]);
			}
			for( j=0;j<grpObjffm.length;j++)
			{
			SelRec123 = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/FFMileage/FFM"))[j];
			if(SelRec123.getAttribute('Status')!="D")
			CreateFFMileageTableRow(SelRec123.getAttribute('Serial'),SelRec123.getAttribute('FFMCode'),SelRec123.getAttribute('Miles'),SelRec123.getAttribute('ExtMiles'),SelRec123);
			}
		}
}	 
function DisplayOutBranchXml(TagName,ComboObj){
 with(document.forms[0]){
			var outBrObj=globalXML.getElementsByTagName(TagName).item(0);
		   for( j=0;j<outBrObj.getElementsByTagName('Branch').length;j++){ 
		   for(i=0;i<ComboObj.options.length;i++)
			    {
				SelRec = outBrObj.getElementsByTagName('Branch').item(j);
				if(ComboObj.options[i].value==SelRec.getAttribute('Code'))
				ComboObj.options[i].selected=true;
				}
			}
			if(outBrObj.getElementsByTagName('Branch').length>0)
			ComboObj.options[0].selected=false;
	}		 
}
function DisplayTourOperatorXml(){
 with(document.forms[0]){
	       for( k=0;k<globalXML.getElementsByTagName('Tour').length;k++)
			{
				SelRec1 = globalXML.getElementsByTagName('Tour').item(k);
				CreateTourTableRow(SelRec1.getAttribute('TourID'),SelRec1);
			}
		}
}
function DisplayCountryReqXml(){
 with(document.forms[0]){
	       for( l=0;l<globalXML.getElementsByTagName('CountReq').length;l++)
			{
				
				SelRec2 = globalXML.getElementsByTagName('CountReq').item(l);
				CreateCountReqTableRow(SelRec2.getAttribute('Code'),SelRec2);
			}
		}
}
function DisplayCountryExcXml(){
 with(document.forms[0]){
	       for( m=0;m<globalXML.getElementsByTagName('CountExc').length;m++)
			{
				SelRec3 = globalXML.getElementsByTagName('CountExc').item(m);
				CreateCountExcTableRow(SelRec3.getAttribute('Code'),SelRec3);
			}
		}
}
function DisplayFlightXml(){
 with(document.forms[0]){
	       for( m=0;m<globalXML.getElementsByTagName('Flight').length;m++)
			{
				SelRec3 = globalXML.getElementsByTagName('Flight').item(m);
				CreateFlightTableRow(SelRec3.getAttribute('Code'),SelRec3);
			}
		}
}
function ToggleOutBrRow(ObjName){
 with(document.forms[0]){
		if(ObjName=="TourOperatorRow"){
			document.getElementById('ShowBranchTr').style.display='none';
			document.getElementById('PaymentRow').style.display='none';
			document.getElementById('CountReqRow').style.display='none';
			document.getElementById('CountExcRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='none';
			document.getElementById('TourOperatorRow').style.display='';
		}
		if(ObjName=="ShowBranchTr"){
			document.getElementById('TourOperatorRow').style.display='none';
			document.getElementById('PaymentRow').style.display='none';
			document.getElementById('CountReqRow').style.display='none';
			document.getElementById('CountExcRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='none';
			document.getElementById('ShowBranchTr').style.display='';
		}
		if(ObjName=="PaymentRow"){
			document.getElementById('TourOperatorRow').style.display='none';
			document.getElementById('ShowBranchTr').style.display='none';
			document.getElementById('CountReqRow').style.display='none';
			document.getElementById('CountExcRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='none';
			document.getElementById('PaymentRow').style.display='';
		}
		if(ObjName=="CountReqRow"){
			document.getElementById('TourOperatorRow').style.display='none';
			document.getElementById('ShowBranchTr').style.display='none';
			document.getElementById('CountExcRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='none';
			document.getElementById('CountReqRow').style.display='';
			document.getElementById('PaymentRow').style.display='none';
		}
		if(ObjName=="CountExcRow"){
			document.getElementById('TourOperatorRow').style.display='none';
			document.getElementById('ShowBranchTr').style.display='none';
			document.getElementById('CountReqRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='none';
			document.getElementById('CountExcRow').style.display='';
			document.getElementById('PaymentRow').style.display='none';
		}
		if(ObjName=="FlightInformationRow"){
			document.getElementById('TourOperatorRow').style.display='none';
			document.getElementById('ShowBranchTr').style.display='none';
			document.getElementById('CountReqRow').style.display='none';
			document.getElementById('CountExcRow').style.display='none';
			document.getElementById('FlightInformationRow').style.display='';
			document.getElementById('PaymentRow').style.display='none';
		}
    }
}
function ShowPaymentRequirment(flag){
 with(document.forms[0]){
		if(flag)
		document.getElementById('ShowBranchTr').style.display='';
		else
		document.getElementById('ShowBranchTr').style.display='none';
    }
}
function CreatePaymentXmlNode(){
with(document.forms[0])
 {
		var PaymentObj=globalXML.getElementsByTagName("PaymentReq").item(0);
			Record=createElementCommon(globalXML,globalXML,'Payment');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Method');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'TypeCode');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record)
			if(!validateRow('PaymentTable','Payment'))
			return false;		
			CreatePaymentTableRow(0,0,Record);
	}
}
function CreateTourXmlNode(){
with(document.forms[0])
 {
		var PaymentObj=globalXML.getElementsByTagName("TourOperator").item(0);
			Record=createElementCommon(globalXML,globalXML,'Tour');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'TourID');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record)
			if(!validateRow('TourTable','Tour Operator'))
			return false;	
			CreateTourTableRow('',Record);
	}
}
function CreateFlightXmlNode(){
with(document.forms[0])
 {
		var PaymentObj=globalXML.getElementsByTagName("AirlinesInfo").item(0);
			Record=createElementCommon(globalXML,globalXML,'Flight');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'FlightID');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record)
			if(!validateRow('FlightTable','Flight Information'))
			return false;	
			CreateFlightTableRow('',Record);
	}
}
function CreateCountReqTableRow(Country1,CountReqXmlObj)
{
 with(document.forms[0])
 {	
	lastRowCReq=0;
	tbl=document.getElementById("CountReqTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowCReq=1;
	}
	else
	{
	
	 
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	 lastRowCReq= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="CReq"+lastRowCReq;
	attachCountReqTrOnClick(tr,lastRowCReq,tbl)
	currentrow=tr.id;
	if(CountReqXmlObj){
			CountReqXmlObj.setAttribute('Serial',lastRowCReq);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowCReq);
      	td.appendChild(text);
      	tr.appendChild(td);
		tr.setAttribute("rowid",lastRowCReq);
		td = document.createElement('TD');
      	textC = document.createElement('select');
      	textC.className="textInputField_CmbLr";	
		textC.style.width="120px";
		textC.id="CountryReq"+lastRowCReq;
      	textC.name="CountryReq"+lastRowCReq;
		buildMethodcombo(textC,CountryCode_arr,CountryText_arr,Country1);	
		UpdateCountReqXml(textC,lastRowCReq);
		td.appendChild(textC);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
		text = createimgnode("CReq"+lastRowCReq,'CountReqTable',lastRowCReq,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
    }
}
function CreateCountExcTableRow(Country1,CountExcXmlObj)
{
 with(document.forms[0])
 {	
	lastRowCReq=0;
	tbl=document.getElementById("CountExcTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowCReq=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowCReq= parseInt(dynamic_id)+1;

	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="CExc"+lastRowCReq;
	attachCountExcTrOnClick(tr,lastRowCReq,tbl)
	currentrow=tr.id;
	if(CountExcXmlObj){
			CountExcXmlObj.setAttribute('Serial',lastRowCReq);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowCReq);
      	td.appendChild(text);
      	tr.appendChild(td);
		tr.setAttribute("rowid",lastRowCReq);
		td = document.createElement('TD');
      	textE = document.createElement('select');
      	textE.className="textInputField_CmbLr";	
		textE.style.width="120px";
		textE.id="CountryExc"+lastRowCReq;
      	textE.name="CountryExc"+lastRowCReq;
		buildMethodcombo(textE,CountryCode_arr,CountryText_arr,Country1);	
		UpdateCountExcXml(textE,lastRowCReq);
		td.appendChild(textE);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
		text = createimgnode("CExc"+lastRowCReq,'CountExcTable',lastRowCReq,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
    }
}
function CreateCountReqXmlNode(){
with(document.forms[0])
 {
			var CountReqObj=globalXML.getElementsByTagName("CountryReq").item(0);
			Record=createElementCommon(globalXML,globalXML,'CountReq');
			var newattr;
			
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Code');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(CountReqObj,Record)
			if(!validateRow('CountReqTable','Country'))
			return false;		
			CreateCountReqTableRow('',Record);
	}
}
function CreateCountExcXmlNode(){
with(document.forms[0])
 {
		var CountExcObj=globalXML.getElementsByTagName("CountryExc").item(0);
			Record=createElementCommon(globalXML,globalXML,'CountExc');
			var newattr;
			
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Code');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(CountExcObj,Record)
			CreateCountExcTableRow('',Record);
	}
}
function CreateExtrasXmlNode(){
with(document.forms[0])
 {
		var PaymentObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Extras"))[0];
			Record=createElementCommon(globalXML,globalXML,'Extra');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Code');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Price');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Included');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Group');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record)
			if(!validateRow('ExtrasTable','Extra'))
			return false;	
			CreateExtrasTableRow(0,0,0,0,Record);
	}
}
function CreateInsuXmlNode(){
with(document.forms[0])
 {
		var InsuObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Insurances"))[0];
			Record=createElementCommon(globalXML,globalXML,'Insu');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Code');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Price');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Included');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Group');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'MaxCharge');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'MinCharge');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'DrvExt');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'CustExt');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Deduct');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'NWDeduct');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			
			appendNodeToParent(InsuObj,Record)
			if(!validateRow('InsuTable','Insurance'))
				return false;		
			CreateInsuTableRow(0,0,0,0,Record,999999,0,0,0,0,0,0,0,'N');
	}
}

function CheckDuplicateInsuCode(CurrCounterExt){
 with(document.forms[0])
	{
	if(CurrCounterExt>0)
	{
		var CurrentExt=document.getElementById('InsuCode'+CurrCounterExt).value;
		var tbl=document.getElementById("InsuTable");
   	    rows1=tbl.tBodies[0].rows;
		for(var x=1;x<rows1.length;x++)
		{	
			var PrevExtra=document.getElementById('InsuCode'+x).value;
				if(x!=CurrCounterExt)
					{     
						if(CurrentExt!="" && PrevExtra!="" && CurrentExt==PrevExtra  )
							{
								alert("|^Insurance Code Already Selected.^|");
								document.getElementById('InsuCode'+CurrCounterExt).value="";
								return false;
							}
					}
		return true;			
		}
	}
} 
}	
function CheckDuplicateExtrasCode(CurrCounterExt){
 with(document.forms[0])
	{
	if(CurrCounterExt>0)
	{
		var CurrentExt=document.getElementById('ExtrasCode'+CurrCounterExt).value;
		var tbl=document.getElementById("ExtrasTable");
   	    rows1=tbl.tBodies[0].rows;
		for(var x=1;x<rows1.length;x++)
		{	
			var PrevExtra=document.getElementById('ExtrasCode'+x).value;
				if(x!=CurrCounterExt)
					{     
						if(CurrentExt!="" && PrevExtra!="" && CurrentExt==PrevExtra  )
							{
								alert("|^Extras Code Already Selected.^|");
								document.getElementById('ExtrasCode'+CurrCounterExt).value="";
								return false;
							}
					}
		return true;			
		}
		
	}
} 
}	
function CreateSuppliXmlNode(){
with(document.forms[0])
 {
		var PaymentObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Suppliment"))[0];
			Record=createElementCommon(globalXML,globalXML,'Suppli');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'FromDate');
			newattr.value=FromDate.value;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'ToDate');
			newattr.value=ToDate.value;
			Record.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Price');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record)
			tbl=document.getElementById("SuppliTable");
			rows=tbl.tBodies[0].rows;
			var NextFromdateParam="";
			if(document.getElementById("ToDate"+(rows.length-1)))
			NextFromdateParam=document.getElementById("ToDate"+(rows.length-1)).value;
			if(NextFromdateParam=="")
			NextFromdateParam=FromDate.value;
			CreateSuppliTableRow(0,NextFromdateParam,ToDate.value,0,Record);
	}
}	
function CreateBillingXmlNode(MonthP1,AMountP1,CalledFromAutocreate1){
with(document.forms[0])
 {
		var PaymentObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/Billing"))[0];
			Record1=createElementCommon(globalXML,globalXML,'Bill');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record1.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Month');
			newattr.value=MonthP1;
			Record1.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Amount');
			newattr.value=AMountP1;
			Record1.setAttributeNode(newattr);
			appendNodeToParent(PaymentObj,Record1)
			if(!validateRow('BillingTable','Billing'))
			return false;		
			CreateBillingTableRow(0,MonthP1,AMountP1,Record1,CalledFromAutocreate1);
	}
}	
function CreateFFMXmlNode(){
with(document.forms[0])
 {
		var FFMObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']/FFMileage"))[0];
			Record1=createElementCommon(globalXML,globalXML,'FFM');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'Serial');
			newattr.value=0;
			Record1.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'FFMCode');
			newattr.value=0;
			Record1.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'Miles');
			newattr.value=0;
			Record1.setAttributeNode(newattr);
			newattr=createAttributeCommon(globalXML,globalXML,'ExtMiles');
			newattr.value=0;
			Record1.setAttributeNode(newattr);
			appendNodeToParent(FFMObj,Record1)
			if(!validateRow('FFMTable','Airline'))
			return false;
			CreateFFMileageTableRow(0,0,0,0,Record1);
	}
}	
function CreatePaymentTableRow(Method12,Type1,SerialNoXmlObj)
{
 with(document.forms[0])
 {	
	
	lastRowPay=0;
	tbl=document.getElementById("PaymentTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowPay=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowPay= parseInt(dynamic_id)+1;
	
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Pay"+lastRowPay;
	attachPaymentTrOnClick(tr,lastRowPay,tbl)
	currentrow=tr.id;
	if(SerialNoXmlObj){
			SerialNoXmlObj.setAttribute('Serial',lastRowPay);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowPay);
      	td.appendChild(text);
      	tr.appendChild(td);
		tr.setAttribute("rowid",lastRowPay);
		td = document.createElement('TD');
      	text = document.createElement('select');
      	text.className="textInputField_CmbLr";	
		text.style.width="120px";
		text.id="Method"+lastRowPay;
      	text.name="Method"+lastRowPay;
		buildMethodcombo(text,MethodCode_arr,MethodText_arr,Method12);	
		td.appendChild(text);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
      	text1 = document.createElement('select');
      	text1.className="textInputField_CmbLr";	
		text1.style.width="120px";
		text1.id="TypeCode"+lastRowPay;
      	text1.name="TypeCode"+lastRowPay;
		//buildExtrascombo(text,Extras_arr,Extrastext_arr);	
        text1.value=Type1;
	  	td.appendChild(text1);
		attachMethodOnClick(text,lastRowPay,text1,Method12,Type1);
		tr.appendChild(td);			
		
		td = document.createElement('TD');
		text = createimgnode("Pay"+lastRowPay,'PaymentTable',lastRowPay,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
		
    }
}
function CreateTourTableRow(IdParam,TourXmlObj)
{
 with(document.forms[0])
 {	
	lastRowTour=0;
		
	tbl=document.getElementById("TourTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowTour=1;
	}
	else
	{
	 
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowTour= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Tour"+lastRowTour;
	attachTourTrOnClick(tr,lastRowTour,tbl)
	currentrow=tr.id;
	if(TourXmlObj){
			TourXmlObj.setAttribute('Serial',lastRowTour);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowTour);
      	td.appendChild(text);
      	tr.appendChild(td);
        tr.setAttribute("rowid",lastRowTour);  
		td = document.createElement('TD');
      	text1 = document.createElement('input');
      	text1.className="textInputField_CmbLr";	
      	text1.disabled=true;	
      	text1.readOnly=true;	
		text1.style.width="120px";
		text1.id="TourID"+lastRowTour;
		text1.value=IdParam;
      	text1.name="TourID"+lastRowTour;
		attachTourOnchange(text1);
		
		text2 = document.createElement('input');
		text2.setAttribute("type",'button');
      	text2.className="zbutton";	
		text2.id="IDBtn"+lastRowTour;
		text2.value="..";
      	text2.name="IDBtn"+lastRowTour;
		AttacheOnClickEvent(lastRowTour,text2,text1);
		td.appendChild(text1);
		td.appendChild(text2);
      	tr.appendChild(td);				

		td = document.createElement('TD');
		text = createimgnode("Tour"+lastRowTour,'TourTable',lastRowTour,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
   }
}
function CreateFlightTableRow(IdParam,FlightXmlObj)
{
 with(document.forms[0])
 {	
	lastRowTour=0;
		
	tbl=document.getElementById("FlightTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowTour=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowTour= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Flight"+lastRowTour;
	attachTourTrOnClick(tr,lastRowTour,tbl)
	currentrow=tr.id;
	if(FlightXmlObj){
			FlightXmlObj.setAttribute('Serial',lastRowTour);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowTour);
      	td.appendChild(text);
      	tr.appendChild(td);
      tr.setAttribute("rowid",lastRowTour);  
		/* td = document.createElement('TD');
      	text1 = document.createElement('input');
      	text1.className="textInputField_CmbLr";	
      	text1.disabled=true;	
      	text1.readOnly=true;	
		text1.style.width="120px";
		text1.id="FlightID"+lastRowTour;
		text1.value=IdParam;
      	text1.name="FlightID"+lastRowTour;
		attachTourOnchange(text1); */
		
		td = document.createElement('TD');
      	textC = document.createElement('select');
      	textC.className="textInputField_CmbLr";	
		textC.style.width="120px";
		textC.id="AirlineID"+lastRowTour;
      	textC.name="AirlineID"+lastRowTour;
		//alert(AirlineCode_arr.length);
		//alert(AirlineText_arr.length);
		buildMethodcombo(textC,AirlineCode_arr,AirlineText_arr,IdParam);	
		UpdateAirlineXml(textC,lastRowTour);
		td.appendChild(textC);
      	tr.appendChild(td);	
		
		/* text2 = document.createElement('input');
      	text2.className="zbutton";	
		text2.id="IDBtn"+lastRowTour;
		text2.value="..";
      	text2.name="IDBtn"+lastRowTour;
		AttacheOnClickEvent(lastRowTour,text2,textC);
		td.appendChild(textC);
		td.appendChild(text2);
      	tr.appendChild(td);			*/

		td = document.createElement('TD');
		text = createimgnode("Flight"+lastRowTour,'FlightTable',lastRowTour,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
   }
}
function AttacheOnClickEvent(CounterP,BtnObj,IDObj){
with(document.forms[0]){
	BtnObj.onclick=function(){
		NewWin('/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=TourOperatorQA&Arguments=-A,-A2,-A,-A,-A'+CounterP,'RentalRate','RentalRate','left=50,top=45,HEIGHT=520,WIDTH=900,scrollbars=1,status=0');
	}
}
}
function CreateExtrasTableRow(Serial1,ExtrasCodeParam,IncludedParam,PriceParam,SerialNoXmlObjParam)
{
 with(document.forms[0])
 {	
	lastRowExt=0;
	tbl=document.getElementById("ExtrasTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowExt=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowExt= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Ext"+lastRowExt;
	attachExtrasTrOnClick(tr,lastRowExt,tbl)
	currentrow=tr.id;
	CurrRowExtra=lastRowExt;
	if(SerialNoXmlObjParam){
			SerialNoXmlObjParam.setAttribute('Serial',lastRowExt);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowExt);
      	td.appendChild(text);		
		tr.setAttribute("rowid",lastRowExt);
		attachTrOnClickExtra(tr,lastRowExt,tbl);
      	tr.appendChild(td);
      
		td = document.createElement('TD');
      	textC = document.createElement('select');
      	textC.className="textInputField_CmbLr";	
		textC.style.width="120px";
		textC.id="ExtrasCode"+lastRowExt;
      	textC.name="ExtrasCode"+lastRowExt;
		buildMethodcombo(textC,ExtrasCode_arr,ExtrasText_arr,ExtrasCodeParam);	
		td.appendChild(textC);
		//textC.onchange=function(){}
		UpdateExtrasXml(textC,lastRowExt,0,0);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
      	textI = document.createElement('select');
      	textI.className="textInputField_CmbLr";				
      	textI.id="Included"+lastRowExt;
      	textI.name="Included"+lastRowExt;
			textI.options[0] = new Option('No','N');
			textI.options[1] = new Option('Yes','Y');
		//text.onchange=function(){UpdateExtrasXml();}
		UpdateExtrasXml(textI,lastRowExt,0,0);
		textI.value=IncludedParam;	
      	td.appendChild(textI);
      	tr.appendChild(td);		
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="100px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="15";
		}
		else
		{
			textP.maxLength="19";
		}
		
		//textP.onchange=function(){UpdateExtrasXml();}
		textP.id="ExtrasPrice"+lastRowExt;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="ExtrasPrice"+lastRowExt;
		textP.value=PriceParam;	
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateExtrasXml(textP,lastRowExt,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateExtrasXml(textP,lastRowExt,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
		text = createimgnode("Ext"+lastRowExt,'ExtrasTable',lastRowExt,'C');
		td.width="2%";
		td.align="center";		
		if(ClickMenuID.value!='V')		
		td.appendChild(text);
		tr.appendChild(td);	
    }
}
function CreateInsuTableRow(Serial1,InsuCodeParam,IncludedParam,PriceParam,SerialNoXmlObjParam,MaxChargeParam,MinChargeParam,DrvExtParam,CustExtParam,DeductParam,NWDeductParam,SuppYoungDrvParam,SuppYoungDrvDeductParam,FromDisplay)
{
 with(document.forms[0])
 {	
	lastRowInsu=0;
	tbl1=document.getElementById("InsuTable");
	rows=tbl1.tBodies[0].rows;
	rowscount=tbl1.tBodies[0].rows.length;
	
	if(rowscount==0)
	{
	 lastRowInsu=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowInsu= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl1.tBodies[0].insertRow(rowscount);
	tr.id="Insu"+lastRowInsu;
	//attachInsuTrOnClick(tr,lastRowInsu,tbl1)
	currentrow=tr.id;
	CurrRowInsu=lastRowInsu;
	if(SerialNoXmlObjParam){
			SerialNoXmlObjParam.setAttribute('Serial',lastRowInsu);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowInsu);
      	td.appendChild(text);		
		tr.setAttribute("rowid",lastRowInsu);
		attachTrOnClickInsu(tr,lastRowInsu,tbl1);
      	tr.appendChild(td);
      
		td = document.createElement('TD');
      	textC = document.createElement('select');
      	textC.className="textInputField_CmbLr";	
		textC.style.width="100px";
		textC.id="InsuCode"+lastRowInsu;
      	textC.name="InsuCode"+lastRowInsu;
		if(FromDisplay=='Y' || parseInt(CompanyFormat.value)!=134)
		{
		buildMethodcombo(textC,InsuCode_arr,InsuText_arr,InsuCodeParam);	
		}
		else
		{
		buildMethodcombo(textC,InsuCodeNew_arr,InsuTextNew_arr,InsuCodeParam);
		}
		td.appendChild(textC);
		//textC.onchange=function(){}
		UpdateInsuXml(textC,lastRowInsu,0,0);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
      	textI = document.createElement('select');
      	textI.style.width="40px";
		textI.className="textInputField_CmbLr";				
      	textI.id="Included"+lastRowInsu;
      	textI.name="Included"+lastRowInsu;
			textI.options[0] = new Option('No','N');
			textI.options[1] = new Option('Yes','Y');
		//text.onchange=function(){UpdateExtrasXml();}
		UpdateInsuXml(textI,lastRowInsu,0,0);
		textI.value=IncludedParam;	
      	td.appendChild(textI);
      	tr.appendChild(td);		
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="10";
		}
		else
		{
			textP.maxLength="19";
		}
		textP.id="InsuPrice"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="InsuPrice"+lastRowInsu;
		textP.value=PriceParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="10";
		}
		else
		{
			textP.maxLength="19";
		}		
		
		textP.id="MaxCharge"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="MaxCharge"+lastRowInsu;
		textP.value=MaxChargeParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="10";
		}
		else
		{
			textP.maxLength="19";
		}		
		
		textP.id="MinCharge"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="MinCharge"+lastRowInsu;
		textP.value=MinChargeParam;	
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
				
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="10";
		}
		else
		{
			textP.maxLength="19";
		}
		
		textP.id="DrvExt"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="DrvExt"+lastRowInsu;
		textP.value=DrvExtParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="10";
		}
		else
		{
			textP.maxLength="19";
		}
				
		textP.id="CustExt"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="CustExt"+lastRowInsu;
		textP.value=CustExtParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="8";
		}
		else
		{
			textP.maxLength="14";
		}
		
		textP.id="Deduct"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="Deduct"+lastRowInsu;
		textP.value=DeductParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,8,0);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,0);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="8";
		}
		else
		{
			textP.maxLength="14";
		}		
		
		textP.id="NWDeduct"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="NWDeduct"+lastRowInsu;
		textP.value=NWDeductParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,8,0);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,0);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="8";
		}
		else
		{
			textP.maxLength="19";
		}
		textP.id="SuppYoungDrv"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="SuppYoungDrv"+lastRowInsu;
		textP.value=SuppYoungDrvParam;	
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
				
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	textP = document.createElement('input');
      	textP.className="textinputfieldMd";		
		textP.style.width="60px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			textP.maxLength="8";
		}
		else
		{
			textP.maxLength="19";
		}
		
		textP.id="SuppYoungDrvDeduct"+lastRowInsu;
		textP.onkeypress=function(){return(CheckFloatKey(event));}
      	textP.name="SuppYoungDrvDeduct"+lastRowInsu;
		textP.value=SuppYoungDrvDeductParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateInsuXml(textP,lastRowInsu,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			UpdateInsuXml(textP,lastRowInsu,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(textP);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
		text = createimgnode("Insu"+lastRowInsu,'InsuTable',lastRowInsu,'C');
		td.width="2%";
		td.align="center";		
		if(ClickMenuID.value!='V')		
		td.appendChild(text);
		tr.appendChild(td);	
    }
}
function CreateSuppliTableRow(Serial1,FromDateParam,ToDateParam,SuppPriceParam,SuppSerialNoXmlObjParam)
{
 with(document.forms[0])
 {	
 	lastRowSup=0;
	tbl=document.getElementById("SuppliTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowSup=1;
	}
	else
	{
	 
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowSup= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Sup"+lastRowSup;
	tr.setAttribute("rowid",lastRowSup);
	attachSuppliTrOnClick(tr,lastRowSup,tbl)
	currentrow=tr.id;
	if(SuppSerialNoXmlObjParam){
			SuppSerialNoXmlObjParam.setAttribute('Serial',lastRowSup);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowSup);
      	td.appendChild(text);
      	tr.appendChild(td);
      
		td = document.createElement('TD');
      	dateF = document.createElement('input');
      	dateF.className="textinputfieldMd";	
		dateF.style.width="60px";
		dateF.id="FromDate"+lastRowSup;
      	dateF.name="FromDate"+lastRowSup;
		//dateF.onchange=function(){if(dateF.value!=''){isDate(dateF,2);}}
		dateF.value=FromDateParam;
		text1 = document.createElement('a');
		text1.innerHTML = "<img src='/EngDev/Images94/QuickAccess/qa_calendar_button.jpg'  border=0 align='absmiddle'>"
      	text1.href="javascript:var cal1 = new calendar(document.getElementById('FromDate'+lastRowSup));cal1.past_future='Y';cal1.popup();"
		td.appendChild(dateF);
		UpdateSuppliXml(dateF,lastRowSup,1,0,0);
		td.appendChild(text1);
      	tr.appendChild(td);					
		
		td = document.createElement('TD');
      	date = document.createElement('input');
      	date.className="textinputfieldMd";	
		date.style.width="60px";
		date.id="ToDate"+lastRowSup;
      	date.name="ToDate"+lastRowSup;
		date.onkeypress=function(){return(CheckFloatKey(event));}
		//date.onchange=function(){if(date.value!=''){isDate(date,2);}}
		date.value=ToDateParam;
		text1 = document.createElement('a');
		text1.innerHTML = "<img src='/EngDev/Images94/QuickAccess/qa_calendar_button.jpg'  border=0 align='absmiddle'>"
      	text1.href="javascript:var cal1 = new calendar(document.getElementById('ToDate'+lastRowSup));cal1.past_future='Y';cal1.popup();"
		td.appendChild(date);
		UpdateSuppliXml(date,lastRowSup,1,0,0);
		td.appendChild(text1);
      	tr.appendChild(td);					
		
		td = document.createElement('TD');
      	text = document.createElement('input');
      	text.className="textinputfieldMd";		
		text.style.width="100px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="12";
		}
		else
		{
			text.maxLength="19";
		}
		
		//text.onchange=function(){UpdateSuppliXml()}
      	text.id="SuppliPrice"+lastRowSup;
	  	text.name="SuppliPrice"+lastRowSup;
		text.onkeypress=function(){return(CheckFloatKeyCB(event));}
		text.value=SuppPriceParam;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			UpdateSuppliXml(text,lastRowSup,0,10,document.forms[0].DecimalFormat.value);	
		}
		else
		{
			UpdateSuppliXml(text,lastRowSup,0,14,document.forms[0].DecimalFormat.value);
		}
		
		td.appendChild(text);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
		text = createimgnode("Sup"+lastRowSup,'SuppliTable',lastRowSup,'C');
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
    }
}

function ValidateBillingMonth(Month,CalledFromAutoCreate)
{	
	with(document.forms[0])
 {
	var grpObj55Temp=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
    var daysParamTemp=grpObj55Temp.getAttribute('PDays');
	var NoOfMonth=parseInt(parseInt(isNaN(parseInt(daysParamTemp))?0:parseInt(daysParamTemp))/30);
	document.getElementById('NumberOfMnth').value=NoOfMonth;
	tbl=document.getElementById("BillingTable");
		rows=tbl.tBodies[0].rows;	
		if((parseInt(CompanyFormat.value)==8 || parseInt(CompanyFormat.value)==100 || parseInt(CompanyFormat.value)==116) && CalledFromAutoCreate==1)	
		{
		for(var n=1;n<Month;n++)
		{
		BillMonthVar=document.getElementById("BillMonth"+n).value;
		BillMonthVar=parseInt(isNaN(parseInt(BillMonthVar))?0:parseInt(BillMonthVar));
		
			//alert("BillMonth="+document.getElementById("BillMonth"+n).value+"   NumberOfMnth.value="+NumberOfMnth.value);
			if(BillMonthVar < 1 || BillMonthVar > NumberOfMnth.value )
			{
				alert("|^Invalid Month^|");
				document.getElementById("BillMonth"+n).value="";
				return false;
			}
			
		}

		}	
	else
		{
		for(var n=1;n<rows.length;n++)
		{
		BillMonthVar=document.getElementById("BillMonth"+n).value;
		BillMonthVar=parseInt(isNaN(parseInt(BillMonthVar))?0:parseInt(BillMonthVar));
		
			//alert("BillMonth="+document.getElementById("BillMonth"+n).value+"   NumberOfMnth.value="+NumberOfMnth.value);
			if(BillMonthVar < 1 || BillMonthVar > NumberOfMnth.value )
			{
				alert("|^Invalid Month^|");
				document.getElementById("BillMonth"+n).value="";
				return false;
			}
			
		}

		}	
	
		tbl=document.getElementById("BillingTable");
	rows=tbl.tBodies[0].rows;
	//rowscount=tbl.tBodies[0].rows.length;
	
		//alert("rowscount="+rowscount+"     NumberOfMnth.value="+NumberOfMnth.value)
		if(rowscount>NumberOfMnth.value && (parseInt(CompanyFormat.value)!=8 && parseInt(CompanyFormat.value)!=100 && parseInt(CompanyFormat.value)!=116))
		{
		alert("|^Invalid Month^|");
		return false;
		}
	
	return true;
	
	
 }
}
function CreateBillingTableRow(Serial1,MonthP,AmountP,BilSerialNoXmlObjParam,CalledFromAutoCreate)
{

 with(document.forms[0])
 {
 	lastRowBil=0;
	tbl=document.getElementById("BillingTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(!ValidateBillingMonth(MonthP,CalledFromAutoCreate))
	return false;
	
	if(rowscount<2)
	{
	 lastRowBil=1;
	}
	else
	{
	 var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowBil= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="Bil"+lastRowBil;
	attachBillTrOnClick(tr,lastRowBil,tbl)
	currentrow=tr.id;
	if(BilSerialNoXmlObjParam){
			BilSerialNoXmlObjParam.setAttribute('Serial',lastRowBil);
		}
	
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowBil);
      	td.appendChild(text);
      	tr.appendChild(td);
		tr.setAttribute("rowid",lastRowBil)
		td = document.createElement('TD');
      	text = document.createElement('input');
      	text.className="textinputfieldMd";		
		text.style.width="100px";
		text.maxLength="6";
		//text.onchange=function(){ValidateBillingMonth();}
      	text.id="BillMonth"+lastRowBil;
		text.onkeypress=function(){return(CheckFloatKey(event));}
      	text.name="BillMonth"+lastRowBil;
		text.value=MonthP;	
		//UpdateBillingXml(text,lastRowBil);
		
		text.onchange=function(){
		BillingOnchangeUpdate(lastRowBil);
		ValidateBillingMonth(MonthP,CalledFromAutoCreate);}
		
		
		
		td.appendChild(text);
      	tr.appendChild(td);					
		
		td = document.createElement('TD');
      	text = document.createElement('input');
      	text.className="textinputfieldMd";		
		text.style.width="100px";
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="13";
		}
		else
		{
			text.maxLength="19";
		}
		
	  	text.id="BillAmount"+lastRowBil;
		text.onkeypress=function(){return(CheckFloatKey(event));}
      	text.name="BillAmount"+lastRowBil;
		text.value=AmountP;	
		UpdateBillingXml(text,lastRowBil);
		td.appendChild(text);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
		text = createimgnode("Bil"+lastRowBil,'BillingTable',lastRowBil,'C');
		td.width="2%";
		td.align="center";			
		if(ClickMenuID.value!='V')		
		td.appendChild(text);
		tr.appendChild(td);	
		
		if(CalledFromAutoCreate==1 && document.getElementById('BillAmount'+lastRowBil))
		BillingOnchangeUpdate(lastRowBil);
		
    }
}
function CreateFFMileageTableRow(Serial1,CodeP,PMilesP,ExtMilesP,FFMXmlObjParam)
{
 with(document.forms[0])
 {	
	lastRowFFM=0;
	tbl=document.getElementById("FFMTable");
	rows=tbl.tBodies[0].rows;
	rowscount=tbl.tBodies[0].rows.length;
	if(rowscount<2)
	{
	 lastRowFFM=1;
	}
	else
	{
	var dynamic_id=rows[rowscount-1].getAttribute("rowid");	
	lastRowFFM= parseInt(dynamic_id)+1;
	}
	var currentrow;
	tr=tbl.tBodies[0].insertRow(rowscount);
	tr.id="FFM"+lastRowFFM;
	attachFFMTrOnClick(tr,lastRowFFM,tbl)
	currentrow=tr.id;
	if(FFMXmlObjParam){
			FFMXmlObjParam.setAttribute('Serial',lastRowFFM);
		}
      	td = document.createElement('TD');
      	text = document.createTextNode(lastRowFFM);
      	td.appendChild(text);
      	tr.appendChild(td);
      
		td = document.createElement('TD');
      	textC = document.createElement('select');
      	textC.className="textInputField_CmbLr";	
		textC.style.width="150px";
		textC.id="FFMCode"+lastRowFFM;
      	textC.name="FFMCode"+lastRowFFM;
		buildMethodcombo(textC,FFMCode_arr,FFMText_arr,CodeP);	
		td.appendChild(textC);
		//textC.onchange=function(){}
		UpdateFFMXml(textC,lastRowFFM,0,0);
      	tr.appendChild(td);						
		
		td = document.createElement('TD');
      	text = document.createElement('input');
      	text.className="textinputfieldMd";		
		text.style.width="60px";
		text.maxLength="5";
		//text.onchange=function(){UpdateBillingXml()}
      	text.id="Miles"+lastRowFFM;
		text.onkeypress=function(){return(CheckFloatKey(event));}
      	text.name="Miles"+lastRowFFM;
		text.value=PMilesP;	
		UpdateFFMXml(text,lastRowFFM);
		td.appendChild(text);
      	tr.appendChild(td);
		
		td = document.createElement('TD');
      	text = document.createElement('input');
      	text.className="textinputfieldMd";		
		text.style.width="60px";
		text.maxLength="5";
		//text.onchange=function(){UpdateBillingXml()}
      	text.id="ExtMiles"+lastRowFFM;
		text.onkeypress=function(){return(CheckFloatKey(event));}
      	text.name="ExtMiles"+lastRowFFM;
		text.value=ExtMilesP;	
		UpdateFFMXml(text,lastRowFFM);
		td.appendChild(text);
      	tr.appendChild(td);		
		
		td = document.createElement('TD');
		text = createimgnode("FFM"+lastRowFFM,'FFMTable',lastRowFFM,'C');
		td.width="2%";
		td.align="center";			
		if(ClickMenuID.value!='V')		
		td.appendChild(text);
		tr.appendChild(td);	
    }
}
function attachMethodOnClick(rowObj,rowCounter,TypeObj,Methodval,TypeVal){
	with(document.forms[0]){
		rowObj.onchange = function(){DynamicComob(rowObj,TypeObj,Methodval,TypeVal);UpdatePaymentXml();}
		TypeObj.onchange = function(){UpdatePaymentXml();}
		DynamicComob(rowObj,TypeObj,Methodval,TypeVal);
	}
}
function attachTourOnchange(IDObject){
	with(document.forms[0]){
		IDObject.onchange = function(){UpdateTourXml();}
	}
}
function DynamicComob(MethodObj,TypeObjParam,Methodval1,TypeVal1){
	with(document.forms[0]){
		if(MethodObj.value=="2"){
			buildMethodcombo(TypeObjParam,ChequeCode_arr,ChequeText_arr,TypeVal1)
			
		}
		if(MethodObj.value=="4" || MethodObj.value=="1"){
			buildMethodcombo(TypeObjParam,CCCode_arr,CCText_arr,TypeVal1)
		}
		if(MethodObj.value!=="4" && MethodObj.value!=="2"){
			TypeObjParam.options.length = 0;
		}
		
	}
}
function validateRow(TableName,SelectValue)
{
 	tbl=document.getElementById(TableName);
	rows=tbl.tBodies[0].rows;										
	rowscount=tbl.tBodies[0].rows.length;	
	with(document.forms[0])
 {  
	
       	for(i=1;i<rowscount;i++)
      	{
        	 cells1=rows[i].cells;	 
			 if(cells1[1].firstChild.value=="" ||cells1[1].firstChild.value==0)
        	 {
			 
        	 	alert("|^Please Select  "+SelectValue+"  ^|");
        		cells1[1].firstChild.focus();
        		return false; 
        	 }	
      	}
}
return true;
}
function validateSec2Row()
{
 	tbl=document.getElementById("DetailsTable");
	rows=tbl.tBodies[0].rows;										
	rowscount=tbl.tBodies[0].rows.length;	
	with(document.forms[0])
 {  
       	for(i=1;i<rowscount;i++)
      	{
//        	 cells1=rows[i].cells;	 
			if(document.getElementById("Group"+i)){
			 if((document.getElementById("Group"+i).value=="" || document.getElementById("Group"+i).value==0) )
        	 {
        	 	alert("|^Please Select Car Group.^|");
        		document.getElementById("Group"+i).focus();
        		return false; 
        	 }
			if((document.getElementById("Package"+i).value=="" || document.getElementById("Package"+i).value==0)  )
        	 {
        	 	alert("|^Please Select Package.^|");
        		document.getElementById("Package"+i).focus();
        		return false; 
        	 }
			 }else return true
      	}
}
return true;
}



function CheckDuplicateTyrType(CurrCounter){
 with(document.forms[0])
	{
	
	if(CurrCounter>0)
	{
	
		if(!document.getElementById('Group'+CurrCounter)){
			return true;
		}
		var AdjCG=document.getElementById('Group'+CurrCounter).value;
		var AdjPKG=document.getElementById('Package'+CurrCounter).value;
		var tbl=document.getElementById("DetailsTable");
   	    rows=tbl.tBodies[0].rows;
		rowscount=tbl.tBodies[0].rows.length;
		for(var x=1;x<rows.length;x++)
		{	if(document.getElementById(('Group'+x))){
			var PrevAdjCG=document.getElementById(('Group'+x)).value;
			var PrevAdjPKG=document.getElementById(('Package'+x)).value;
				if(x!=CurrCounter)
					{ 
					    if((AllowRateSrNoLogic.value!='Y' || (AllowRateSrNoLogic.value=='Y' && RateUpdateSRNo.value=='N')) && AdjCG!="" && PrevAdjCG!="" && AdjPKG!="" && PrevAdjPKG!="" && AdjCG==PrevAdjCG && AdjPKG==PrevAdjPKG   )
							{
								alert("Car Group or Package already Exist");
								document.getElementById('Group'+CurrCounter).value="";
								document.getElementById('Package'+CurrCounter).value="";
								
								return false;
							}
					}
					else
							return true;
							
							}
		}
	}
} 
}

function CheckBillingAmount(CurrCounter){
 with(document.forms[0])
	{
		if(CurrCounter>0)
		{
				tbl=document.getElementById("BillingTable");
				rows=tbl.tBodies[0].rows;
				rowscount=tbl.tBodies[0].rows.length;
				if(rowscount==1 || rowscount==0)
				{
					alert("|^Please Enter Billing Amount^|")
					return false;
				
				}
		
				if(rowscount>1)
				{
						var i=0;						
						for(i=1;i<rowscount;i++)
						{
							if(document.getElementById("BillAmount"+i).value==0 || document.getElementById("BillAmount"+i).value=="")
							{
								alert("|^Please Enter Billing Amount^|")
								return false;
							}
							else
						return true;
						}
						
				}
		}
			
	} 

}


function createimgnode(trID,TabelName,SrNo,ModeCM)
{
    text=document.createElement('img');
    text.src='/EngDev/Images94/QuickAccess/delete.gif'
    text.id="DelDelete"+lastRow;
    text.name="DelDelete"+lastRow; 
    text.alt='|^Delete^|';
    text.onclick=function(){DeleteRow(trID,TabelName,SrNo,ModeCM);}
    return text;
}
function DeleteRow(trID1,TabelName12,SrNo1,ModeCMParam)
{

    with(document.forms[0])
    { 
	if(RateExist.value=="1" && TabelName12=="DetailsTable" && ModeCMParam!='C')
	{
		alert("|^Cannot delete rate as this rate is already assigned to Agreement or Reservation.^|");
		return false;
	}
	if(confirm ("|^Are you sure you want to delete this Row^|"))
		{
			if(TabelName12=='DetailsTable')
			var tag1="Section2/Record[SrNo='"+parseInt(SrNo1)+"']";
			if(TabelName12=='PaymentTable')
			var tag1="PaymentReq/Payment[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='CountReqTable')
				var tag1="CountryReq/CountReq[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='CountExcTable')
				var tag1="CountryExc/CountExc[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='ExtrasTable')
			var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/Extras/Extra[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='InsuTable')
			var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/Insurances/Insu[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='SuppliTable')
			var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/Suppliment/Suppli[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='BillingTable')
			var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/Billing/Bill[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='FFMTable')
			var tag1="Section2/Record[SrNo='"+parseInt(currentRowId)+"']/FFMileage/FFM[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='TourTable')
			var tag1="TourOperator/Tour[Serial='"+parseInt(SrNo1)+"']";
			if(TabelName12=='FlightTable')
			var tag1="AirlinesInfo/Flight[Serial='"+parseInt(SrNo1)+"']";
			var jd=(getJQXMLElementsArray(globalXML,tag1))[0];
						if(jd)
						{
							if(TabelName12=='PaymentTable' || TabelName12=='CountReqTable' || TabelName12=='CountExcTable' || TabelName12=='TourTable' || TabelName12=='FlightTable')
							jd.parentNode.removeChild(jd);
							jd.setAttribute('Status','D');
							if(TabelName12=='DetailsTable')
							EnableDisableBt(true);
			    		}
						else
						{
    						alert('|^Error While Deleting Row...^|');
						}
						
						if(TabelName12=='ExtrasTable' || TabelName12=='InsuTable' || TabelName12=='SuppliTable' || TabelName12=='BillingTable' || TabelName12=='FFMTable')
						UpdateSec2Status();
						
		tb=document.getElementById(TabelName12);
  		tb.tBodies[0].removeChild(document.getElementById(trID1));
  }
 }
}
function ClearPaymentTable(){
	with(document.forms[0])
	{
		tbl=document.getElementById("PaymentTable");
        rows=tbl.tBodies[0].rows;
		for(i=1;i<=rows.length;i++) {
			if(document.getElementById(i))
			tbl.tBodies[0].removeChild(document.getElementById(i));
		} 
	}
}
function buildMethodcombo(ExtrasCodeObj,CodeArrayName,TextArrayName,SelectedVal)
{
with(document.forms[0])
{
		CodeArrayName[0]=0;
    	TextArrayName[0]="";
    	ExtrasCodeObj.options.length=CodeArrayName.length;
		
    	for(i=0;i<CodeArrayName.length;i++)
    	{
    	ExtrasCodeObj.options[i].value=CodeArrayName[i];
    	ExtrasCodeObj.options[i].text=TextArrayName[i];
		ExtrasCodeObj.options[i].title=TextArrayName[i];
    	}
		ExtrasCodeObj.value=SelectedVal;
		}
}
function HighLightRow(tbl,row)
{
	with(document.forms[0])
    {
	   if(row.style.backgroundColor=="#BEC5DE")
            return true;
       for(var i=0;i<tbl.rows.length;i++)
       {
            if(i%2==0)
                tbl.rows[i].style.backgroundColor="#f7f7f7";
            else
                tbl.rows[i].style.backgroundColor="#FFFFFF";
                    
       }
	   row.style.backgroundColor="#8297C4";
       var cells = row.cells;
    }
}
function HighLightRowInsu(tbl,row)
{
	with(document.forms[0])
    {
		insuCopy.disabled=false;
	   if(row.style.backgroundColor=="#BEC5DE")
            return true;
       for(var i=0;i<tbl.rows.length;i++)
       {
            if(i%2==0)
                tbl.rows[i].style.backgroundColor="#f7f7f7";
            else
                tbl.rows[i].style.backgroundColor="#FFFFFF";
                    
       }
	   row.style.backgroundColor="#8297C4";
       var cells = row.cells;
    }
}
function HighLightRowExtra(tbl,row)
{
	with(document.forms[0])
    {
		ExtrCopy.disabled=false;
	   if(row.style.backgroundColor=="#BEC5DE")
            return true;
       for(var i=0;i<tbl.rows.length;i++)
       {
            if(i%2==0)
                tbl.rows[i].style.backgroundColor="#f7f7f7";
            else
                tbl.rows[i].style.backgroundColor="#FFFFFF";
                    
       }
	   row.style.backgroundColor="#8297C4";
       var cells = row.cells;
    }
}
function HighLightRowSec2(tbl,row)
{ with(document.forms[0])
    {
		HideToolTipWindow('Zoom_Extras_Win');
		HideToolTipWindow('Zoom_Insu_Win');
		HideToolTipWindow('Zoom_KmDetail_Win');	
		HideToolTipWindow('Zoom_Suppli_Win');
		HideToolTipWindow('Zoom_Billing_Win');
		HideToolTipWindow('Zoom_FFMileage_Win');
		EnableDisableBt(false);
       if(row.style.backgroundColor=="#BEC5DE")
            return true;
       for(var i=0;i<tbl.rows.length;i++)
       {
            if(i%2==0)
                tbl.rows[i].style.backgroundColor="#f7f7f7";
            else
                tbl.rows[i].style.backgroundColor="#FFFFFF";
       }
       row.style.backgroundColor="#8297C4";
       var cells = row.cells;
 }   }	   
function attachTrOnClick(rowObj,rowCounter,tbl){
	with(document.forms[0]){
		rowObj.onclick = function(){HighLightRowSec2(tbl,rowObj);currentRowId = rowCounter;}
	}
}
function attachExtrasTrOnClick(rowObjEx,rowCounterEx,tblEx){
	with(document.forms[0]){
		rowObjEx.onclick = function(){HighLightRow(tblEx,rowObjEx);currentExtrasRowId=rowCounterEx}
	}
}
function attachInsuTrOnClick(rowObjIns,rowCounterIns,tblIns){
	with(document.forms[0]){
		rowObjIns.onclick = function(){HighLightRow(tblIns,rowObjIns);currentInsuRowId=rowCounterIns}
	}
}
function attachSuppliTrOnClick(rowObjSupp,rowCounterSupp,tblSupp){
	with(document.forms[0]){
		rowObjSupp.onclick = function(){HighLightRow(tblSupp,rowObjSupp);currentSuppRowId=rowCounterSupp;}
	}
}
function attachBillTrOnClick(rowObjBil,rowCounterBil,tblBil){
	with(document.forms[0]){
		rowObjBil.onclick = function(){currentBillRowId=rowCounterBil;HighLightRow(tblBil,rowObjBil);}
	}
}
function attachFFMTrOnClick(rowObjFFM,rowCounterFFM,tblFFM){
	with(document.forms[0]){
		rowObjFFM.onclick = function(){currentFFMRowId=rowCounterFFM;HighLightRow(tblFFM,rowObjFFM);}
	}
}
function attachPaymentTrOnClick(rowObj1,rowCounter1,tbl2){
	with(document.forms[0]){
		rowObj1.onclick = function(){HighLightRow(tbl2,rowObj1);currentPayRowId=rowCounter1;}
		rowObj1.onmouseover = function(){HighLightRow(tbl2,rowObj1);currentPayRowId=rowCounter1;}
		
	}
}
function attachTourTrOnClick(rowObj41,rowCounter41,tbl24){
	with(document.forms[0]){
		rowObj41.onclick = function(){HighLightRow(tbl24,rowObj41);currentTourRowId=rowCounter41;}
		rowObj41.onmouseover = function(){HighLightRow(tbl24,rowObj41);currentTourRowId=rowCounter41;}
		
	}
}
function attachCountReqTrOnClick(rowObj41,rowCounter41,tbl24){
	with(document.forms[0]){
		rowObj41.onclick = function(){HighLightRow(tbl24,rowObj41);currentCountReqRowId=rowCounter41;}
		rowObj41.onmouseover = function(){HighLightRow(tbl24,rowObj41);currentCountReqRowId=rowCounter41;}
		
	}
}
function attachCountExcTrOnClick(rowObj41,rowCounter41,tbl24){
	with(document.forms[0]){
		rowObj41.onclick = function(){HighLightRow(tbl24,rowObj41);currentCountExcRowId=rowCounter41;}
		rowObj41.onmouseover = function(){HighLightRow(tbl24,rowObj41);currentCountExcRowId=rowCounter41;}
		
	}
}	   
function attachTrOnClickInsu(rowObj,rowCounter,tbl){
	with(document.forms[0]){
		rowObj.onclick = function(){HighLightRowInsu(tbl,rowObj);CurrRowInsu = rowCounter;}
	}
}	   
function attachTrOnClickExtra(rowObj,rowCounter,tbl){
	with(document.forms[0]){
		rowObj.onclick = function(){HighLightRowExtra(tbl,rowObj);CurrRowExtra = rowCounter;}
	}
}
var currentRowId=0;
var currentPayRowId=0;
var currentTourRowId=0;
var currentCountReqRowId=0;
var currentCountExcRowId=0;
var currentExtrasRowId=0;
var currentInsuRowId=0;
var currentInsuRowId=0;
var currentSuppRowId=0;
var currentBillRowId=0;
var currentFFMRowId=0;
var PriceOrBilling=0;
var CurrRowInsu=0;
var CurrRowExtra=0;
function Save_AddInsInfo()
{
    with(document.forms[0])
    { 		
		if(!validateSec2Row())
		return false;
		if(parseInt(CompanyFormat.value)==65)
		if(NewRowCreated==1)
		{
		
			NewRowCreated=0;
			currentRowId=NewRowCreatedId;
			attachTrOnClick(NewrowObj,NewRowCreatedId,NewTbl);
			show_Insu_Zoom(event)
			return false;
		}
		tbl=document.getElementById("DetailsTable");
		rows=tbl.tBodies[0].rows;										
		rowscount=tbl.tBodies[0].rows.length;	
		for(i=1;i<rowscount;i++)
      	{
			 if(!CheckDuplicateTyrType(i))
				return false;
		}		
		
		currentRowId=0;
        var root=globalXML.getElementsByTagName('Root').item(0);
		var sec2=globalXML.getElementsByTagName('Section2').item(0);
		
		if(currentRowId != 0){
			var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
		
        grpObj.setAttribute('AdditionalHourPercent',AdditionalHourPercent.value);
		grpObj.setAttribute('ExtraHourPrice',ExtraHourPrice.value);
		grpObj.setAttribute('ExtrasKMPrice',ExtrasKMPrice.value);
		grpObj.setAttribute('KMForExtraHour',KMForExtraHour.value);
		grpObj.setAttribute('KmInclude',KmIncluded.value);
		grpObj.setAttribute('LateHourNoCharge',LateHourNoCharge.value);
		
		grpObj.setAttribute('PublicOffDay',PublicOffDay.value);
		grpObj.setAttribute('OffDayFactor',OffDayFactor.value);
		grpObj.setAttribute('ChfExtraDayPrice',ChfExtraDayPrice.value);
		grpObj.setAttribute('ChfHrIncluPerDay',ChfHrIncluPerDay.value);
		grpObj.setAttribute('ChfExtHrPrice',ChfExtHrPrice.value);
       	}
			else
			{
			Record=createElementCommon(globalXML,globalXML,'Record');
			var newattr;
			newattr=createAttributeCommon(globalXML,globalXML,'SrNo');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'RateSrNO');
			newattr.value=0;
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Group');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Price');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Status');
			newattr.value='M';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'Package');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'CustChargePerKm');
			newattr.value='0';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'CustExtPrice');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'DrvChargePerKm');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'DrvExtPrice');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'ExtAllwPerDay');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'KMAllwPerPack');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'MaxKmToCharge');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			newattr=createAttributeCommon(globalXML,globalXML,'MaxKmToChargeType');
			newattr.value='';
			Record.setAttributeNode(newattr);
			
			appendNodeToParent(sec2,Record)
			
			var ExtrasRecord=createElementCommon(globalXML,globalXML,'Extras');
			appendNodeToParent(Record,ExtrasRecord)
			var InsuRecord=createElementCommon(globalXML,globalXML,'Insurances');
			appendNodeToParent(Record,InsuRecord)
			var FFMRecord=createElementCommon(globalXML,globalXML,'FFMileage');
			appendNodeToParent(Record,FFMRecord)
			var SuppRecord=createElementCommon(globalXML,globalXML,'Suppliment');
			appendNodeToParent(Record,SuppRecord)
			var BillRecord=createElementCommon(globalXML,globalXML,'Billing');
			appendNodeToParent(Record,BillRecord)
		}	
		if(!validateSec2Row())
				return false;
					
		CreateRateTableRow(0,0,0,0,0,0,0,0,0,0,Record,0,0,0,0,0,0,'C')
		return true;
    }
}
function test()
{
alert(45)
}
function SetSec2RowId(FieldObj1,SelectedRowID2,IntegerLimit1,DecimalLimit1,PackageObj1,DaysObj1,HourObj1,MinObj1)
{
	with(document.forms[0])
	{
		FieldObj1.onblur=function(){currentRowId=SelectedRowID2;}
		FieldObj1.onchange=function(){test();
		SetSec2RowIdOnchange(FieldObj1,SelectedRowID2,IntegerLimit1,DecimalLimit1,PackageObj1,DaysObj1,HourObj1,MinObj1);
		}
		
	}
}	
function SetSec2RowIdKm(FieldObj1,SelectedRowID2,IntegerLimit1,DecimalLimit1,PackageObj1,DaysObj1,HourObj1,MinObj1)
{
	with(document.forms[0])
	{
		FieldObj1.onblur=function(){currentRowId=SelectedRowID2;}
		FieldObj1.onchange=function(){
		CalculateExtAllwPerDay(FieldObj1,SelectedRowID2);
		SetSec2RowIdOnchange(FieldObj1,SelectedRowID2,IntegerLimit1,DecimalLimit1,PackageObj1,DaysObj1,HourObj1,MinObj1);
		
		}
		
	}
}
function SetSec2RowIdOnBlur(FieldObj,SelectedRowID)
{
	with(document.forms[0])
	{
		FieldObj.onblur=function(){currentRowId=SelectedRowID;}
	}
}	
function SetSec2RowIdOnchange(FieldObj,SelectedRowID,IntegerLimit,DecimalLimit,PackageObj,DaysObj,HourObj,MinObj)
{
	with(document.forms[0])
	{
		currentRowId=SelectedRowID;
		if(parseFloat(IntegerLimit)>0){
		if(!DecimalValidate(FieldObj,IntegerLimit,DecimalLimit))
		return false
		}
		if(PackageObj)
		SetPackageDays(PackageObj,SelectedRowID,DaysObj,HourObj,MinObj);
		if(FieldObj.id=="Price"+SelectedRowID){
		
			var PriceP=document.getElementById("Price"+SelectedRowID).value;
			var DaysP=document.getElementById("Days"+SelectedRowID).value;
			var HoursP=document.getElementById("Hours"+SelectedRowID).value;
			var MinP=document.getElementById("Min"+SelectedRowID).value;
			
			
			if(parseInt(isNaN(parseInt(DaysP))?0:parseInt(DaysP))!=0)
			{
			var DrvExt=parseFloat(isNaN(parseFloat(PriceP))?0:parseFloat(PriceP))/(parseInt(isNaN(parseInt(DaysP))?0:parseInt(DaysP))+parseInt(isNaN(parseInt(DaysP))?0:parseInt(HoursP))/24)
			}
			if(parseInt(isNaN(parseInt(DaysP))?0:parseInt(DaysP))==0 && parseInt(isNaN(parseInt(DaysP))?0:parseInt(HoursP))!=0)
			{
			var DrvExt=parseFloat(isNaN(parseFloat(PriceP))?0:parseFloat(PriceP))/(parseInt(isNaN(parseInt(DaysP))?0:parseInt(DaysP))+parseInt(isNaN(parseInt(DaysP))?0:parseInt(HoursP)))
			}
			if(parseInt(isNaN(parseInt(DaysP))?0:parseInt(DaysP))==0 && parseInt(isNaN(parseInt(DaysP))?0:parseInt(HoursP))==0 && parseInt(isNaN(parseInt(DaysP))?0:parseInt(MinP)))
			{
			var DrvExt=parseFloat(isNaN(parseFloat(PriceP))?0:parseFloat(PriceP))/(parseInt(isNaN(parseInt(DaysP))?0:parseInt(MinP)))
			}
			
			
			document.getElementById("DrvExtPrice"+SelectedRowID).value=DrvExt.toFixed(DecimalFormat.value);
			document.getElementById("CustExtPrice"+SelectedRowID).value=DrvExt.toFixed(DecimalFormat.value);
			
		}
		UpdatetoXML();
		
		
	}
}	
function UpdatetoXML()
{
    with(document.forms[0])
    {
		if(currentRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
        
		grpObj.setAttribute('Group',document.getElementById('Group'+currentRowId).value);
		grpObj.setAttribute('PHours',document.getElementById('Hours'+currentRowId).value);
		grpObj.setAttribute('PMin',document.getElementById('Min'+currentRowId).value);
		grpObj.setAttribute('Package',document.getElementById('Package'+currentRowId).value);
		grpObj.setAttribute('PDays',document.getElementById('Days'+currentRowId).value);
		grpObj.setAttribute('Price',document.getElementById('Price'+currentRowId).value);
		
		grpObj.setAttribute('CustChargePerKm',document.getElementById('CustChargePerKm'+currentRowId).value);
		grpObj.setAttribute('CustExtPrice',document.getElementById('CustExtPrice'+currentRowId).value);
		grpObj.setAttribute('DrvChargePerKm',document.getElementById('DrvChargePerKm'+currentRowId).value);
		grpObj.setAttribute('DrvExtPrice',document.getElementById('DrvExtPrice'+currentRowId).value);
		grpObj.setAttribute('ExtAllwPerDay',document.getElementById('ExtAllwPerDay'+currentRowId).value);
		grpObj.setAttribute('KMAllwPerPack',document.getElementById('KMAllwPerPack'+currentRowId).value);
		grpObj.setAttribute('MaxKmToCharge',document.getElementById('MaxKmToCharge'+currentRowId).value);
		grpObj.setAttribute('MaxKmToChargeType',document.getElementById('MaxKmToChargeType'+currentRowId).value);
		grpObj.setAttribute('Status',"M");
	   	}
	}
}	
function UpdateSec2Status()
{
    with(document.forms[0])
    {
		if(currentRowId != 0){
		var grpObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0];
 		grpObj.setAttribute('Status',"M");
	   	}
	}
}
var lastRow=0;
function CheckDuplicateGroup(CurrCounter,TableName1){
 with(document.forms[0])
	{
	return true;
	if(CurrCounter>0)
	{
		var AdjR=document.getElementById('Group'+CurrCounter).value;
		var tbl=document.getElementById(TableName1);
      	    rows=tbl.tBodies[0].rows;
	for(i=1;i<rows.length;i++)
		{	
			var PrevAdjR=document.getElementById('Group'+i).value;
				if(i!=CurrCounter)
					{     
						if(AdjR!="" && PrevAdjR!="" && AdjR==PrevAdjR  )
							{
								alert("|^Car Group Already Selected.^|");
								document.getElementById('Group'+CurrCounter).value="";
								return false;
							}
					}
					else
							return true;
		}
	 }
	} 
 }
function SetPackageDays(FieldObj1,RowSel,DaysObj,HourObj,MinObj){
 with(document.forms[0])
	{
		if(FieldObj1.value!="0"){
		DaysObj.value=PackageDays_arr[FieldObj1.selectedIndex];
		HourObj.value=PackageHour_arr[FieldObj1.selectedIndex];
		MinObj.value=PackageMin_arr[FieldObj1.selectedIndex];
		}
	}
}	
function CreateRateTableRow(SrNo,RateSrNO,GroupP,PackageP,DaysP,HoursP,MinP,PriceP,DrvExtP,CustExtP,SrNoXmlObj,KMALLPerPckP,ExtAllPerPckP,DrvPricePKM,CstPricePKM,MaxKmtoChrge,MaxKmtoChrgeTypeP,ModeParam)
{
 with(document.forms[0])
 {	
		tbl=document.getElementById("DetailsTable");
        rows=tbl.tBodies[0].rows;
        rowscount=tbl.tBodies[0].rows.length;
        if(SrNo == 0){
			cells = rows[rowscount-1].cells;
		
			lastRow =parseInt(isNaN(parseInt(Sec2Count.value))?0:parseInt(Sec2Count.value));
			Sec2Count.value=parseInt(isNaN(parseInt(Sec2Count.value))?0:parseInt(Sec2Count.value))+1
			lastRow = parseInt(lastRow) + 1;
			}
		else
			lastRow = SrNo;
			
		if(SrNoXmlObj){
			SrNoXmlObj.setAttribute('SrNo',lastRow);
		}
		currentRowId = lastRow;
        tr=tbl.tBodies[0].insertRow(rowscount);
        tr.id="Det"+lastRow;
		attachTrOnClick(tr,lastRow,tbl)
      	td = document.createElement('TD');
		td.style.width="20px";
      	text = document.createTextNode(lastRow);
      	td.appendChild(text);
      	tr.appendChild(td);
		
		
		if(AllowRateSrNoLogic.value=='Y')
		{
		td = document.createElement('TD');
		td.style.width="45px";
		textS = document.createElement('input');
      	textS.value=RateSrNO;
      	textS.className="readOnly_textInputField_AmtNr";	
      	textS.id="RateSrNO"+lastRow;
      	textS.name="RateSrNO"+lastRow;
		textS.readOnly=true;
		td.appendChild(textS);
      	tr.appendChild(td);
		}
		
		td = document.createElement('TD');
		td.style.width="80px";
      	textGr = document.createElement('select');
      	textGr.className="textInputField_CmbLr";	
		textGr.style.width="60px";
		textGr.id="Group"+lastRow;
      	textGr.name="Group"+lastRow;
		buildMethodcombo(textGr,GroupCode_arr,GroupText_arr,GroupP);	
		SetSec2RowId(textGr,lastRow,0,0);
		textGr.value=GroupP;
		if(ModeParam=="M")
		textGr.disabled=true;
		else
		textGr.disabled=false;
		td.appendChild(textGr);
      	tr.appendChild(td);				
		
		td = document.createElement('TD');
		td.style.width="<!$MG_DyTDSize>px";
		td.setAttribute("nowrap",true);
      	text3 = document.createElement('select');
      	text3.className="textInputField_CmbLr";	
		text3.style.width="120px";
		text3.id="Package"+lastRow;
		text3.name="Package"+lastRow;
		if(ModeParam=="M")
		text3.disabled=true;
		else
		text3.disabled=false;
		SetSec2RowId(text3,lastRow,0,0);
		buildMethodcombo(text3,PackageCode_arr,PackageText_arr,PackageP);	
      
	    textD = document.createElement('input');
      	textD.value=DaysP;
      	textD.className="readOnly_textInputField_AmtNr";	
      	textD.id="Days"+lastRow;
      	textD.name="Days"+lastRow;
		textD.readOnly=true;
		textD.tabIndex=-1;
		
		textH = document.createElement('input');
		textH.className="readOnly_textInputField_AmtNr";	
		textH.readOnly=true;
		textH.value=HoursP;
		textH.id="Hours"+lastRow;
      	textH.name="Hours"+lastRow;
		textH.tabIndex=-1;
		
		textM = document.createElement('input');
		textM.className="readOnly_textInputField_AmtNr";	
		textM.readOnly=true;
		textM.value=MinP;
		textM.id="Min"+lastRow;
      	textM.name="Min"+lastRow;
		if(AllowCarShare.value!='Y')
		{
		textM.style.display="none";
		}
		textM.tabIndex=-1;
		
		
		td.appendChild(text3);
		td.appendChild(textD);
		td.appendChild(textH);
		td.appendChild(textM);
		SetSec2RowId(text3,lastRow,0,0,text3,textD,textH,textM);
		tr.appendChild(td);	
				
		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="14";
		}
		else
		{
			text.maxLength="19";	
		}
      	text.value=PriceP;
      	text.className="textinputfieldMd";	
      	text.id="Price"+lastRow;
      	text.name="Price"+lastRow;
		
      	if(parseInt(CompanyFormat.value)!=120)
		{
			SetSec2RowId(text,lastRow,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			SetSec2RowId(text,lastRow,14,document.forms[0].DecimalFormat.value);
		}
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);

		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
      	text.value=DrvExtP;
      	text.className="textinputfieldMd";	
      	text.id="DrvExtPrice"+lastRow;
      	text.name="DrvExtPrice"+lastRow;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="10";
			SetSec2RowId(text,lastRow,6,document.forms[0].DecimalFormat.value);
		}
		else
		{
			text.maxLength="19";
			SetSec2RowId(text,lastRow,14,document.forms[0].DecimalFormat.value);
		}
		
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);

		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
      	text.value=CustExtP;
      	text.className="textinputfieldMd";	
      	text.id="CustExtPrice"+lastRow;
      	text.name="CustExtPrice"+lastRow;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="10";
			SetSec2RowId(text,lastRow,6,document.forms[0].DecimalFormat.value);
		}
		else
		{
			text.maxLength="19";
			SetSec2RowId(text,lastRow,14,document.forms[0].DecimalFormat.value);
		}
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);	

		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
      	text.value=KMALLPerPckP;
      	text.className="textinputfieldMd";	
      	text.id="KMAllwPerPack"+lastRow;
      	text.name="KMAllwPerPack"+lastRow;
		text.maxLength="6";
		SetSec2RowId(text,lastRow,10,document.forms[0].DecimalFormat.value,1);
		text.onkeypress=function(){return(CheckFloatKey(event));test();}
		td.appendChild(text);
		tr.appendChild(td);	
		
		td = document.createElement('TD');
		td.style.width="110px";
      	text = document.createElement('input');
      	text.value=ExtAllPerPckP;
      	text.className="textinputfieldMd";	
      	text.id="ExtAllwPerDay"+lastRow;
      	text.name="ExtAllwPerDay"+lastRow;
		text.maxLength="5";
			SetSec2RowIdKm(text,lastRow,10,document.forms[0].DecimalFormat.value);
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);	
		
		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
      	text.value=DrvPricePKM;
      	text.className="textinputfieldMd";	
      	text.id="DrvChargePerKm"+lastRow;
      	text.name="DrvChargePerKm"+lastRow;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="15";
			SetSec2RowId(text,lastRow,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			text.maxLength="19";
			SetSec2RowId(text,lastRow,14,document.forms[0].DecimalFormat.value);
		}
		
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);	
		
		td = document.createElement('TD');
		td.style.width="100px";
      	text = document.createElement('input');
      	text.value=CstPricePKM;
      	text.className="textinputfieldMd";	
      	text.id="CustChargePerKm"+lastRow;
      	text.name="CustChargePerKm"+lastRow;
		
		if(parseInt(CompanyFormat.value)!=120)
		{
			text.maxLength="15";
			SetSec2RowId(text,lastRow,10,document.forms[0].DecimalFormat.value);
		}
		else
		{
			text.maxLength="19";
			SetSec2RowId(text,lastRow,14,document.forms[0].DecimalFormat.value);	
		}
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);	
		
		td = document.createElement('TD');
		td.style.width="80px";
      	text = document.createElement('input');
      	text.value=MaxKmtoChrge;
      	text.className="textinputfieldMd";	
      	text.id="MaxKmToCharge"+lastRow;
      	text.name="MaxKmToCharge"+lastRow;
			text.maxLength="8";
		SetSec2RowId(text,lastRow,8,0);
		text.onkeypress=function(){return(CheckFloatKey(event));}
		td.appendChild(text);
		tr.appendChild(td);	

		td = document.createElement('TD');
		td.style.width="100px";
      	textI = document.createElement('select');
      	textI.className="textInputField_CmbLr";				
      	textI.id="MaxKmToChargeType"+lastRow;
      	textI.name="MaxKmToChargeType"+lastRow;
		textI.options[0] = new Option('Per Agreement','1');
		textI.options[1] = new Option('Per Day','2');
		textI.value=MaxKmtoChrgeTypeP;	
		SetSec2RowId(textI,lastRow,0,0);
      	td.appendChild(textI);
      	tr.appendChild(td);		
		
		td = document.createElement('TD');
		td.style.width="37px";
		text = createimgnode("Det"+lastRow,'DetailsTable',lastRow,ModeParam);
		td.width="2%";
		td.align="center";				
		if(ClickMenuID.value!='V')
		td.appendChild(text);
		tr.appendChild(td);	
		if(textGr)
		textGr.focus();
		//document.getElementById("Group"+lastRow).focus();	
		//alert(lastRow)
		if(lastRow>15)	
		document.getElementById('Scroll').style.display='';
		NewRowCreated=1;
		NewRowCreatedId=lastRow;
		NewrowObj=tr;
		NewTbl=tbl;
    }
}
function EnableDisableBt(TrueFalse)
{
 	with(document.forms[0])
	{	
		Extras_BT.disabled=TrueFalse;
		Suppli_BT.disabled=TrueFalse;
		CopyGr_BT.disabled=TrueFalse;
		Billing_BT.disabled=TrueFalse;
		Insur_BT.disabled=TrueFalse;
		FFMileage_BT.disabled=TrueFalse;
		
		if(ClickMenuID.value=="V")
		{
		CopyGr_BT.disabled=true;
		Proceed_BT.disabled=true;
		}
	}
}
function check_form()
{
 	with(document.forms[0])
	{	
		if(RateISNNo.value=="" || RateISNNo.value=="0"){
			alert("Rate ISN No cannot be Zero.");
			return false;
		}
		if(RateNo.value=="" || RateNo.value=="0"){
			alert("|^Rate No cannot be Zero.^|");
			return false;
		}
		if(RateName.value==""){
			alert("|^Please enter Rate Name^|");
			RateName.focus();
			return false;
		}
		if(FromDate.value=="0" || FromDate.value=="00/00/0000" || FromDate.value==""){
			alert("|^Please enter From Date^|");
			FromDate.focus();
			return false;
		}
		if(ToDate.value=="0" || ToDate.value=="00/00/0000" || ToDate.value==""){
			alert("|^Please enter To Date^|");
			ToDate.focus();
			return false;
		}
		if(parseInt(CompanyFormat.value)==82)
		{
			if(ClickMenuID.value=="C")
			{
				if(!isValidDateRange())
					return false;
			}
		}
		//if(!validateSec2Row())    --- removed this logic as it takes long time for records more than 1000
			//return false;
//		if(!validateRow('ExtrasTable','Extras'))
		//return false;	
		RateNo.disabled=false;
		FromDate.disabled=false;
		RateCurr.disabled=false;
		UpdateRateSec1();
		DetailLinesBlob.value=getXMLStringFromObject(globalXML);
		//if(CompanyFormat.value==89)
		//{
		tbl=document.getElementById("DetailsTable"); 
		rows=tbl.tBodies[0].rows;										
		rowscount=tbl.tBodies[0].rows.length;	
		for(var m=1;m<rowscount;m++)
      	{
			 if(!CheckDuplicateTyrType(m))
				return false;
		}
		//}
		if(CompanyFormat.value==135)
		{
		tbl=document.getElementById("DetailsTable"); 
		rows=tbl.tBodies[0].rows;										
		rowscount=tbl.tBodies[0].rows.length;	
	
		for(var m=1;m<rowscount;m++)
      	{
				var grpObj55Temp=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+m+"']"))[0];
				var daysParamTemp=grpObj55Temp.getAttribute('PDays');
			if(parseInt(MinDayForSLDef.value)==parseInt(daysParamTemp) && ClickMenuID.value=='C')
			{
				 if(!CheckBillingAmount(m))
					return false;
			}
		}
		}
		
		if(CompanyFormat.value==109)
		{
		tbl=document.getElementById("DetailsTable"); 
		rows=tbl.tBodies[0].rows;										
		rowscount=tbl.tBodies[0].rows.length;	
	
		for(var m=1;m<rowscount;m++)
      	{
				var grpObj55Temp=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+m+"']"))[0];
				var daysParamTemp=grpObj55Temp.getAttribute('PDays');
				
				
			if(parseInt(MinDayForSLDef.value)<=parseInt(daysParamTemp) && (ClickMenuID.value=='C' || ClickMenuID.value=='M'))
			{
				 if(!CheckBillingAmountXML(m))
					return false;
			}
		}
		}
		
			
		if(parseInt(CompanyFormat.value)==65)
		if(NewRowCreated==1)
		{
		
			NewRowCreated=0;
			currentRowId=NewRowCreatedId;
			attachTrOnClick(NewrowObj,NewRowCreatedId,NewTbl);
			show_Insu_Zoom(event)
			return false;
		}
		
		submit();
	}
}


function CheckBillingAmountXML(CurrCounter){
 with(document.forms[0])
	{
    var BilCOunt=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+CurrCounter+"']/Billing/Bill"));
	var DelCount=0;
	var SelectRec;
	for(var y=0;y<BilCOunt.length;y++){
	 SelectRec = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+CurrCounter+"']/Billing/Bill"))[y];
	// alert(SelectRec.xml)
	if(SelRec123.getAttribute('Status')=="D")
	DelCount=DelCount+1;
	}
	
		if(BilCOunt.length==0 || BilCOunt.length==DelCount)
		{
		alert("|^Please Enter Billing Amount^|")
		return false;
		}
		else
		return true;
			}
		}


function isValidDateRange(){
 with(document.forms[0])
	{
					var ValidateXML;		    
					var fdate1=covertDDMMYYYYInToYYYYMMDD(document.getElementById('FromDate').value);
					var urlOc = 'CommonXMLValidationProg&Arguments=-A59,-A'+RateNo.value+',-A'+RateCurr.value+',-A'+fdate1+',-A'+ToDate.value;
					ValidateXML = loadDefXml(urlOc);
					var  PersonXmlRoot = ValidateXML.getElementsByTagName("Root").item(0);
					var PersonFoundYN=getElementValue(PersonXmlRoot,"AlreadyExists");
					if(PersonFoundYN == "Y")
					{
						alert("|^Overlapping Period^|");
						//RateNo.value="";
						FromDate.value="";
						ToDate.value="";
						FromDate.focus();
						return false;
					}
					return true;
    }
} 
function covertDDMMYYYYInToYYYYMMDD(ddmmyyyy){
    if (trim(ddmmyyyy).length != 0) {
	    return ddmmyyyy.substring(6,10) + ddmmyyyy.substring(3,5) + ddmmyyyy.substring(0,2);  // 25/12/2009
    }
	return "";
}
function CopyCarGroup(){
 	with(document.forms[0])
	{
	if(CopyToGroup.value=="" || CopyToGroup.value=="0"){
		alert("|^Please select Car Group To Copy.^|");
		CopyToGroup.focus();
		return false;
	}
	
	if(!ValidatCarGroup())
	return false;	
		var clone = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+currentRowId+"']"))[0].cloneNode(true);
		clone.setAttribute('Group',CopyToGroup.value);
		clone.setAttribute('Status','C');
		total=(parseFloat(isNaN(parseFloat(ChangeByPercent.value))?0:ChangeByPercent.value)/100)*parseFloat(isNaN(parseFloat(clone.getAttribute('Price')))?0:clone.getAttribute('Price'));
		total=total+parseFloat(isNaN(parseFloat(clone.getAttribute('Price')))?0:clone.getAttribute('Price'));
		clone.setAttribute('Price',total);
	
		CreateRateTableRow(0,clone.getAttribute('RateSrNO'),clone.getAttribute('Group'),clone.getAttribute('Package'),clone.getAttribute('PDays'),clone.getAttribute('PHours'),clone.getAttribute('PMin'),clone.getAttribute('Price'),clone.getAttribute('DrvExtPrice'),clone.getAttribute('CustExtPrice'),clone,clone.getAttribute('KMAllwPerPack'),clone.getAttribute('ExtAllwPerDay'),clone.getAttribute('DrvChargePerKm'),clone.getAttribute('CustChargePerKm'),clone.getAttribute('MaxKmToCharge'),clone.getAttribute('MaxKmToChargeType'),'C');
		
		globalXML.getElementsByTagName('Section2').item(0).appendChild(clone);
		HideToolTipWindow('Zoom_CopyGroup_Win');
		
	}
}
function ValidatCarGroup(){
 with(document.forms[0])
	{
		var tbl=document.getElementById('DetailsTable');
        rows=tbl.tBodies[0].rows;
		for(i=1;i<rows.length;i++)
		{	
			if(document.getElementById('Group'+i)){
			var PrevAdjR=document.getElementById('Group'+i).value;
						if(CopyToGroup.value!="" && PrevAdjR!="" && CopyToGroup.value==PrevAdjR  )
							{
								alert("|^Car Group Already Exist.Please select different Car Group^|");
								CopyToGroup.value="";
								return false;
							}
			}				
		}
		return true;
	} 
}
function CustDisOnCHange(){
 with(document.forms[0])
	{
	if(CustomerExtensionDiscount.value=='Y'){
	CustExtDiscountPerc.readOnly=false;
	CustExtDiscountPerc.className="textInputField_AmtLr";
	}
	else {
	CustExtDiscountPerc.readOnly=true;
	CustExtDiscountPerc.className="readOnly_textInputFieldMd";
	CustExtDiscountPerc.value="0.00"
	}
 }
}
function CheckRateNo(){
 with(document.forms[0])
	{
	var ValidateXML;		    
					var urlOc = 'CommonXMLValidation&Arguments=-A30,-A'+RateNo.value+',-A'+RateCurr.value+',-A'+FromDate.value+',-A'+ToDate.value;
					ValidateXML = loadDefXml(urlOc);
        			var  PersonXmlRoot = ValidateXML.getElementsByTagName("Root").item(0);
					var PersonFoundYN=getElementValue(PersonXmlRoot,"RateIndexExists");
					var RateExistsAuto=getElementValue(PersonXmlRoot,"RateExistsAuto");
					var RateNameParam=getElementValue(PersonXmlRoot,"RateIndexName");
					if(PersonFoundYN == "Y")
					{
						alert("|^Rate Code already exists for Rate^| "+RateNameParam);
						RateNo.value="";
						RateNo.focus();
						return false;
					}
					if(RateExistsAuto == "Y")
					{
						alert("|^Rate exists with same parameters!^|")
						RateNo.value="";
						RateNo.focus();
						return false;
					}
    }
}  

function openCarGroupZWin(callfrm) {
	with(document.forms[0]){
	//alert();
	if(callfrm == 'E')
		NewWin("/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=[Z]CarGroupsList&Arguments=-A,-A,-A,-A"+SpecGrp.value,"copyExtrasRateWin","copyExtrasRateWin","left=90,top=90,HEIGHT=565,WIDTH=900,scrollbars=1,status=0,resizable=1");
	else
		NewWin("/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=[Z]CarGroupsList&Arguments=-A,-A,-A,-A"+SpecGrp.value,"copyInsuRateWin","copyInsuRateWin","left=90,top=90,HEIGHT=565,WIDTH=900,scrollbars=1,status=0,resizable=1");	
	}
}
function enableDisable() {
	with(document.forms[0]){
		if(!validateRow('InsuTable','Insurance'))
				return false;		
		else{
			copyInsu.style.display="";
			enableCargrp();
			return true;
		}
	}
}
function enableDisableExtra() {
	with(document.forms[0]){
		if(!validateRow('ExtrasTable','Extras'))
				return false;		
		else{
			copyExtra.style.display="";
			enableCargrpExtra();
			return true;
		}
	}
}
function enableCargrp() {
	with(document.forms[0]){
		if(AllGroups.value == "Y")
			carGrpBtn.disabled=true;
		else
			carGrpBtn.disabled=false;
	}
}
function enableCargrpExtra() {
	with(document.forms[0]){
		if(AllGroupsExtr.value == "Y")
			carGrpBtnExtra.disabled=true;
		else
			carGrpBtnExtra.disabled=false;
	}
}
function savetoAllGroups() {
	with(document.forms[0]){
		var tbl=document.getElementById("DetailsTable");
		var rows=tbl.tBodies[0].rows;										
		var rowscount=tbl.tBodies[0].rows.length;	
		for(i=1;i<rowscount;i++){
			var recordObj = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']"))[0];
			recordObj.setAttribute('Status',"M");
			if(i != currentRowId){
				var SerialNo = globalXML.getElementsByTagName("Section2/Record[@SrNo='"+i+"']/Insurances/Insu");
				var SrNo = isNaN(parseInt(SerialNo.length))?0:parseInt(SerialNo.length)+1;
				
				var tblInsu=document.getElementById("InsuTable");
				var rowsInsu=tblInsu.tBodies[0].rows;
				var rowscountInsu=tblInsu.tBodies[0].rows.length;
				for(j=1;j<=rowscountInsu;j++)
				{
					var InsuObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']/Insurances"))[0];
					Record=createElementCommon(globalXML,globalXML,'Insu');
					var newattr;
				//newattr=globalXML.createAttribute('Serial');
					newattr=createAttributeCommon(globalXML,globalXML,'Serial');
					newattr.value=SrNo;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Code');
					newattr.value=document.getElementById('InsuCode'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Price');
					newattr.value=document.getElementById('InsuPrice'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Included');
					newattr.value=document.getElementById('Included'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Group');
					newattr.value=0;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'MaxCharge');
					newattr.value=document.getElementById('MaxCharge'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'MinCharge');
					newattr.value=document.getElementById('MinCharge'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'DrvExt');
					newattr.value=document.getElementById('DrvExt'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'CustExt');
					newattr.value=document.getElementById('CustExt'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Deduct');
					newattr.value=document.getElementById('Deduct'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'NWDeduct');
					newattr.value=document.getElementById('NWDeduct'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'SuppYoungDrv');
					newattr.value=document.getElementById('SuppYoungDrv'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'SuppYoungDrvDeduct');
					newattr.value=document.getElementById('SuppYoungDrvDeduct'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Status');
					newattr.value="M";
					Record.setAttributeNode(newattr);
					
					appendNodeToParent(InsuObj,Record);
					
					SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
				}				
					SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
			}
		}
		UpdateSec2Status();
	}
}
function saveToSpecificGrp() {
	with(document.forms[0]){
		var tbl=document.getElementById("DetailsTable");
		var rows=tbl.tBodies[0].rows;										
		var rowscount=tbl.tBodies[0].rows.length;	
		for(i=1;i<rowscount;i++){								
			var recordObj = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']"))[0];
			var grp=recordObj.getAttribute('Group');
			recordObj.setAttribute('Status',"M");
			if(i != currentRowId){				
				if(grp == SpecGrp.value){

					var SerialNo = globalXML.getElementsByTagName("Section2/Record[@SrNo='"+i+"']/Insurances/Insu");
					//InsuObj.getElementsByTagName("Insu");
				
					var SrNo = isNaN(parseInt(SerialNo.length))?0:parseInt(SerialNo.length)+1;
					
					var tblInsu=document.getElementById("InsuTable");
					var rowsInsu=tblInsu.tBodies[0].rows;
					var rowscountInsu=tblInsu.tBodies[0].rows.length;
					for(j=1;j<=rowscountInsu;j++)
					{					
						var InsuObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']/Insurances"))[0];
						Record=createElementCommon(globalXML,globalXML,'Insu');
						var newattr;
						newattr=createAttributeCommon(globalXML,globalXML,'Serial');
						newattr.value=SrNo;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Code');
						newattr.value=document.getElementById('InsuCode'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Price');
						newattr.value=document.getElementById('InsuPrice'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Included');
						newattr.value=document.getElementById('Included'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Group');
						newattr.value=0;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'MaxCharge');
						newattr.value=document.getElementById('MaxCharge'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'MinCharge');
						newattr.value=document.getElementById('MinCharge'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'DrvExt');
						newattr.value=document.getElementById('DrvExt'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'CustExt');
						newattr.value=document.getElementById('CustExt'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Deduct');
						newattr.value=document.getElementById('Deduct'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'NWDeduct');
						newattr.value=document.getElementById('NWDeduct'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'SuppYoungDrv');
						newattr.value=document.getElementById('SuppYoungDrv'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'SuppYoungDrvDeduct');
						newattr.value=document.getElementById('SuppYoungDrvDeduct'+j).value;
						Record.setAttributeNode(newattr);
						newattr=createAttributeCommon(globalXML,globalXML,'Status');
						newattr.value="M";
						Record.setAttributeNode(newattr);
						
						appendNodeToParent(InsuObj,Record);
						SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
						SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
					}
					
				}
			}
		}
		UpdateSec2Status();
	}
}
function SaveCopyInsu() {
	with(document.forms[0]){
		if(AllGroups.value == "Y")
			savetoAllGroups();				
		else
			saveToSpecificGrp();
	
		copyInsu.style.display="none";
	}
}

function SaveCopyExtra() {
	with(document.forms[0]){
		if(AllGroupsExtr.value == "Y")
			savetoAllGroupsExtra();				
		else
			saveToSpecificGrpExtra();
	
		copyExtra.style.display="none";
	}
}

function savetoAllGroupsExtra() {
	with(document.forms[0]){
		var tbl=document.getElementById("DetailsTable");
		var rows=tbl.tBodies[0].rows;										
		var rowscount=tbl.tBodies[0].rows.length;	
		for(i=1;i<rowscount;i++){
			var recordObj = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']"))[0];
			recordObj.setAttribute('Status',"M");
			if(i != currentRowId){
				var SerialNo = globalXML.getElementsByTagName("Section2/Record[@SrNo='"+i+"']/Extras/Extra");
				var SrNo = isNaN(parseInt(SerialNo.length))?0:parseInt(SerialNo.length)+1;
				
				var tblExt=document.getElementById("ExtrasTable");
				var rowsExt=tblExt.tBodies[0].rows;
				var rowscountExt=tblExt.tBodies[0].rows.length;
				for(j=1;j<rowscountExt;j++)
				{
					var ExtraObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']/Extras"))[0];
					Record=createElementCommon(globalXML,globalXML,'Extra');
					var newattr;
					newattr=createAttributeCommon(globalXML,globalXML,'Serial');
					newattr.value=SrNo;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Code');
					newattr.value=document.getElementById('ExtrasCode'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Price');
					newattr.value=document.getElementById('ExtrasPrice'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Included');
					newattr.value=document.getElementById('Included'+j).value;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Group');
					newattr.value=0;
					Record.setAttributeNode(newattr);
					newattr=createAttributeCommon(globalXML,globalXML,'Status');
					newattr.value='M';
					Record.setAttributeNode(newattr);
					
					ExtraObj.appendChild(Record);
					SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
				}
			}
		}
		
	}
}

function saveToSpecificGrpExtra() {
	with(document.forms[0]){
		var tbl=document.getElementById("DetailsTable");
		var rows=tbl.tBodies[0].rows;										
		var rowscount=tbl.tBodies[0].rows.length;	
		for(i=1;i<rowscount;i++){
			var recordObj = (getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']"))[0];
			var grp=recordObj.getAttribute('Group');
			recordObj.setAttribute('Status',"M");
			if(i != currentRowId){
				
				if(grp == SpecGrpExtra.value){
					var SerialNo = globalXML.getElementsByTagName("Section2/Record[@SrNo='"+i+"']/Extras/Extra");
					//InsuObj.getElementsByTagName("Insu");
				
					var SrNo = isNaN(parseInt(SerialNo.length))?0:parseInt(SerialNo.length)+1;
					
					var tblExt=document.getElementById("ExtrasTable");
					var rowsExt=tblExt.tBodies[0].rows;
					var rowscountExt=tblExt.tBodies[0].rows.length;
					for(j=1;j<rowscountExt;j++)
					{	
						var ExtraObj=(getJQXMLElementsArray(globalXML,"Section2/Record[SrNo='"+i+"']/Extras"))[0];
						Record=createElementCommon(globalXML,globalXML,'Extra');
						var newattr;	
						
						newattr=createAttributeCommon(globalXML,globalXML,'Serial');
						newattr.value=SrNo;
						Record.setAttributeNode(newattr);
						
						newattr=createAttributeCommon(globalXML,globalXML,'Code');
						newattr.value=document.getElementById('ExtrasCode'+j).value;
						Record.setAttributeNode(newattr);
						
						newattr=createAttributeCommon(globalXML,globalXML,'Price');
						newattr.value=document.getElementById('ExtrasPrice'+j).value;
						Record.setAttributeNode(newattr);
						
						newattr=createAttributeCommon(globalXML,globalXML,'Included');
						newattr.value=document.getElementById('Included'+j).value;
						Record.setAttributeNode(newattr);
						
						newattr=createAttributeCommon(globalXML,globalXML,'Group');
						newattr.value=0;
						Record.setAttributeNode(newattr);
						
						newattr=createAttributeCommon(globalXML,globalXML,'Status');
						newattr.value='M';
						Record.setAttributeNode(newattr);				
						
						ExtraObj.appendChild(Record);
						SrNo = isNaN(parseInt(SrNo))?0:parseInt(SrNo)+1;
					}
				}
			}
		}
		
	}
}


function FlightInfo()
{

with (document.forms[0]){

var CheckFlight=document.getElementById('FlightInformation').value;

		if(CheckFlight=='N')
				document.getElementById("FlightBtn").style.display='none';
		 else
				document.getElementById("FlightBtn").style.display=''; 
		document.getElementById('FlightInformationRow').style.display='none';		
  }

}
function printFunction()
	
	{
	 with(document.forms[0])
 {
	NewWin("/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=GetRentalRateDetail&Arguments=-A"+SelectedCompCode.value+",-A"+SelectedCurr.value+",-A"+SelectedFromDate.value,"transporter11","transporter11","left=165,top=90,HEIGHT=600,WIDTH=950,scrollbars=1,status=0,resizable=1"); 
	
	}
	}
	
function GetWeekRate(){
	with(document.forms[0]){
	NewWin('/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=Weekend_Rate_QA&Arguments=-A'+document.getElementById('WeekRateCode').value+',-A'+document.getElementById('WeekRateName').value+',-A2','WeekRatePick','WeekRatePick','left=160,top=70,HEIGHT=525,WIDTH=865,scrollbars=1,status=0,resizable=1');
	}
}

function ValidateRate()
{
	with(document.forms[0])
	{
		if(parseInt(WeekRateCode.value)==0 || WeekRateCode.value=="")
		{
				alert("|^Enter Valid Code^|");
				document.getElementById("WeekRateCode").value="";
				document.getElementById("WeekRateName").value="";
				WeekRateCode.focus();
				return false;
		}
		if(parseInt(WeekRateCode.value)!=0 || WeekRateCode.value!="")
		{
		
			var ValidateXML;		    
			var urlOc = 'Weekend_Rate_QA_Proceed&Arguments=-A'+WeekRateCode.value+',-A,-AX';
			ValidateXML = loadDefXml(urlOc);
			var  PersonXmlRoot = ValidateXML.getElementsByTagName("Root").item(0);
			var PersonFoundYN;
			PersonFoundYN=$(PersonXmlRoot.getElementsByTagName("AlreadyExists").item(0)).text();
			if(PersonFoundYN == "Y")
			{
				document.getElementById("WeekRateCode").value=$(PersonXmlRoot.getElementsByTagName("Code").item(0)).text();
				document.getElementById("WeekRateName").value=$(PersonXmlRoot.getElementsByTagName("Name").item(0)).text();
			}
			else
			{
				alert("Enter Valid Rate Code");
				document.getElementById("WeekRateCode").value="";
				document.getElementById("WeekRateName").value="";
				return false;
			}
		}
		
	}
}
function CheckBlankCode(FieldType)
{
	with(document.forms[0])
	{
		if(document.getElementById("RateNo").value=='')
		{
			alert('|^Please Enter Rate No^| ');
			RateNo.focus();
			return false;
		}
		else
		{
		NewWin('/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=SetupDescription&Arguments=-A'+document.forms[0].RateNo.value+',-A8,-A'+FieldType,'InsuranceNameWin','InsuranceNameWin','height=650,WIDTH=900,top=40,LEFT=120,scrollbars=1,resizable=1');
		
		}
	}
}


function DeleteRec(){
	with(document.forms[0]){
	if(confirm("|^Do you want to delete the selected record?^|"))
	{		
		DeleteBtn.disabled =true;
		RateNo.disabled =false;
		FromDate.disabled =false;
		RateCurr.disabled =false;
		CalledFrom.value=2;
		ARGUMENTS.value="-A"+RateNo.value+",-A,-A"+CalledFrom.value+",-AD,-A"+RateCurr.value+",-A"+FromDate.value;
			 submit();
			 
	}
	}
}

function RateLog111()
{
	with(document.forms[0])
	{

	
     NewWin('/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=Rate_log&Arguments=-A,-A'+document.forms[0].RateNo.value+',-A,-A,-A,-A,-A,-AC','Ratelog','Ratelog','height=650,WIDTH=900,top=40,LEFT=120,scrollbars=1,resizable=1');
	}
}

function checkAmountAndPercent(amountfieldid, percentfieldid)
	{
		 var amountfield = document.getElementById(amountfieldid);
		 var percentfield = document.getElementById(percentfieldid);
 		 var amountval = isNaN(parseFloat(trim(amountfield.value))) ?  0.0 : parseFloat(trim(amountfield.value));
		 var percentval = isNaN(parseFloat(trim(percentfield.value))) ? 0.0 : parseFloat(trim(percentfield.value));
			if( amountval == 0.0 && percentval == 0.0 )
			{
				updateFieldClass(percentfield, "textInputFieldMD", false);
				updateFieldClass(amountfield, "textInputFieldLR", false);

			}else 
			if( amountval != 0.0 && percentval == 0.0)
			{
				updateFieldClass(percentfield, "readOnly_textInputFieldMD", true);
				updateFieldClass(amountfield, "textInputFieldLR", false);
			
			}else 
			if( percentval != 0.0 && amountval == 0.0)
			{
				updateFieldClass(amountfield, "readOnly_textInputFieldLR", true);
				updateFieldClass(percentfield, "textInputFieldMD", false);
			}
	}

function disableEnableLable(lableid, dis)
	{
		document.getElementById(lableid).disabled = dis;
	}
function updateFieldClass(field, clazz, read_only)
	{
		field.className = clazz;
		field.readOnly = read_only; 
	}
function CalculateExtAllwPerDay(KMAllwPerPackField,Counter)
{
	with(document.forms[0])
	{
		KMAllwPerPackField.value=parseInt(isNaN(parseInt(KMAllwPerPackField.value))?0:parseInt(KMAllwPerPackField.value))
		document.getElementById('ExtAllwPerDay'+Counter).value=KMAllwPerPackField.value/document.getElementById('Days'+Counter).value
		
	}
}
</script>
</head>
<body onload="Cursor()" leftmargin="1" topmargin="5" onUnload="">
<form action="/Magic94Scripts/mgrqispi94.dll" method="post" name="test" >
<INPUT type="hidden" name="APPNAME" value="RentProWeb">
<INPUT type="hidden" id="Prgname" name="PRGNAME" value="RentalRateTableWeb">
<input type="hidden" name="ARGUMENTS" value="RateNo,DetailLinesBlob,CalledFrom,-A,RateCurr,FromDate,WeekRateCode,DeactiveDate,CallFromCopy">					
<input type="Hidden" name="CalledFrom" value="1">
<input type="Hidden" name="DetailLinesBlob" value="">
<input type="hidden" name="CompanyFormat" value="<!$MG_CompanyFormat>">
<input type="hidden" name="DecimalFormat" id="DecimalFormat" value="<!$MG_DecimalFormat>">
<input type="hidden" name="Mode"  id="Mode" value="<!$MG_Mode>">
<input type="hidden" name="ProcessWindowNo" value="">
<input type="hidden" name="RateISNNo" value="<!$MG_RateISNNo>">
<input type="hidden" name="ClickMenuID" id="ClickMenuID" value="<!$MG_ClickMenuID>">
<input type="hidden" name="RateExist" value="<!$MG_RateExist>">
<input type="hidden" name="MinDayForSLDef" value="<!$MG_MinDayForSLDef>">
<input type="hidden" name="Sec2Count" value="">
<input type="hidden" name="RateAssignedOnAgrRes" value="<!$MG_RateAssignedOnAgrRes>">
<input type="hidden" name="SelectedCompCode" value="<!$MG_SelectedCompCode>">
<input type="hidden" name="SelectedCurr" value="<!$MG_SelectedCurr>">
<input type="hidden" name="SelectedFromDate" value="<!$MG_SelectedFromDate>">
<input type="hidden" name="NumberOfMnth" id="NumberOfMnth" value="">
<input type="hidden" name="CSRFCode" id="CSRFCode" value="<!$MG_CSRFCode>">
<input type="hidden" name="PrevMenuId" id="PrevMenuId" value="<!$MG_PrevMenuId>">
<input type="hidden" name="CallFromCopy" id="CallFromCopy" value="<!$MG_CallFromCopy>">
<input type="hidden" name="AllowCarShare" id="AllowCarShare" value="<!$MG_AllowCarShare>">
<input type="hidden" name="AllowRateSrNoLogic" id="AllowRateSrNoLogic" value="<!$MG_AllowRateSrNoLogic>">
<input type="hidden" name="RateUpdateSRNo" id="RateUpdateSRNo" value="<!$MG_RateUpdateSRNo>">



<select name="Modelcombo" id="Modelcombo"  style="display:none">
	 <option value="0" selected></option>
</select>
					 
<TABLE  border=0 cellspacing=0 cellpadding=0 width="100%">
<tr>
    <td valign="top" class="LeftCorner">&nbsp;&nbsp;&nbsp;&nbsp;</td>
    <td width="100%"valign="middle" class="MainHeader">|^Rental <!$MG_RateTypename> Rate ^|</td>
	 <td valign="middle" class="MainHeader" id="fororix" style="display:none;"><SPAN id="Z2" align=left style="display:visible"> <img src="/EngDev/Images94/QuickAccess/printer_icon.jpg" align="center" alt="Print" id="Print_BT" name="Print_BT" onclick="Javascript:printFunction();"> </span></td>	
    <td valign="middle" class="MainHeader" id="MainHeaderid">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>								
</tr>	
<tr>
    <td valign="top" class="LeftBorder"><!--DWLayoutEmptyCell-->&nbsp;</td>				
    <td  width="100%">
    <!-- Every thing goes in this block -->
    <table class="Tablebox"  width="100%"   cellspacing=0 CELLPADDING=0><!-- Main Table -->
    <tr>
        <td>
        <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
        <tr>									
            <td>
            <table  width="100%"  cellspacing=2 cellpadding=2 border=1 class="box">
						<TR>
							    										<TD  colspan="6" class="NormalImgRightCorner"><span class="WindowHeader"> |^Rate Information^|</span>
																					</TD>
																	</TR>
            <tr >
                  <td >|^Rate No^|</td>
                  <td colspan=1>
                  <input type="text" name="RateNo" id="RateNo" maxlength=10 class="textInputFieldMd"  value="<!$MG_RateNo>" style="width:100px" onchange="CheckRateNo();"> &nbsp;</td>
				   <td >|^Rate Name^|</td>
				  <td colspan=1>
                 <input type="text" id="RateName" name="RateName" class="textInputFieldMd"  value="" maxlength=20 style="width:120px" > &nbsp; 
				 <input type="button" class="zbutton" value=".." name="RateName_BT=" id="RateName_BT" align="center" onclick="CheckBlankCode(1);" /></td>
				 <td >|^Currency^|</td>
				  <td colspan=1>
                 <select name="RateCurr" id="RateCurr" style="width:79px" onchange="CheckRateNo();" class="textInputField_CmbMD">
						<!$MG_CurrencyCombo>
					</select>&nbsp; </td>
					
                  
            </tr>
          	<tr> <td >|^Valid From Date^|</td>
				  <td colspan=1>
                 <input class="textinputfieldMd" type="text"name="FromDate" id="FromDate" value="<!$MG_RateFromDate>" onchange="if(this.value!=''){isDate(this);CheckRateNo();}" onblur="if(this.value!=''){isDate(this);}" style="width:70px" maxlength="10">
						<a  id="C2" name="C2" href="javascript:var cal1 = new calendar(document.forms[0].FromDate);cal1.past_future='';cal1.popup();"   >
						<img src="/EngDev/Images94/QuickAccess/qa_calendar_button.jpg"  border=0 align="absmiddle">
						</a> &nbsp;
				  </td>
				  <td >|^Valid To Date^|</td>
				  <td colspan=1>
                 <input class="textinputfieldMd" type="text" id="ToDate" name="ToDate" value="" onchange="if(this.value!=''){isDate(this);if(compareDatesByValue(document.forms[0].FromDate.value,document.forms[0].ToDate.value)){alert('Invalid Date');document.forms[0].ToDate.value=''}}" onblur="if(this.value!=''){isDate(this);}" style="width:70px" maxlength="10">
						<a  name="C2" id="C3" href="javascript:var cal1 = new calendar(document.forms[0].ToDate);cal1.past_future='';cal1.popup();"   >
						<img src="/EngDev/Images94/QuickAccess/qa_calendar_button.jpg"  border=0 align="absmiddle">
						</a> &nbsp;
				  </td>
				  <td>|^Refer Driver Ext^|</td>
				<td>
                <select name="RefDrvExt" id="RefDrvExt" class="textInputField_CmbMd" style="width:100px;"> <!-- onchange="statusAR();"-->
                <option value="N">|^No^|</option>
                <option value="Y">|^Yes^|</option>																	
                </select>
            </td>
			</tr>
			<tr>
			<td ><span id="RateTypeTD">|^Tariff Class^|</span></td>
				<td colspan="1">
				<select name="TariffClass" id="TariffClass" style="width:120px"  onchange="" class="textInputField_CmbMD">
				<option value=""></option>
				<!$MG_TariffClsCombo>		
				</select>
				</td>
			    <td >|^International Code^|</td>
				  <td <!$MGIF_SMT125> <!$MGELSE> colspan=3<!$MGENDIF>>
                 <input type="text" id="InternationalCode" name="InternationalCode" class="textInputFieldMd"  value="" maxlength=8 style="width:120px" > &nbsp; </td>
				 <!$MGIF_SMT125>
				  <td >|^Weekend Rate^|</td>
				   <td > <input type="text" id="WeekRateCode" name="WeekRateCode" class="textInputFieldLr"  value="<!$MG_WeekRateNo>" maxlength=4 style="width:50px" onchange="ValidateRate()"> 
				   <img  src="/EngDev/Images94/QuickAccess/qa_zoom_button.jpg" id="WeekRatePick"name="WeekRatePick" onclick="GetWeekRate();">
				   <input type="text" id="WeekRateName" name="WeekRateName" class="readOnly_textInputFieldLr" readOnly value="<!$MG_WeekRatName>" maxlength=20 style="width:120px" ></td>
				   <!$MGENDIF>
			</tr>
			<tr>
			<td <!$MGIF_ApplyDeactive> <!$MGELSE> style="display:none"<!$MGENDIF> >|^De-active Date^|</td>
				  <td <!$MGIF_ApplyDeactive>  <!$MGELSE> style="display:none"<!$MGENDIF> >
                 <input class="textinputfieldMd" type="text" id="DeactiveDate" name="DeactiveDate" <!$MGIF_DeactiveNonZero>  readOnly<!$MGELSE> <!$MGENDIF> value="<!$MG_DeactiveDate>" onchange="if(this.value!=''){isDate(this);if(compareDatesByValue(document.forms[0].FromDate.value,document.forms[0].DeactiveDate.value)){alert('Invalid Date');document.forms[0].DeactiveDate.value=''}}" onblur="if(this.value!=''){isDate(this);}" style="width:70px" maxlength="10">
						<a  name="C5" id="C5" <!$MGIF_DeactiveNonZero> <!$MGELSE>href="javascript:var cal1 = new calendar(document.forms[0].DeactiveDate);cal1.past_future='';cal1.popup();" <!$MGENDIF>  >
						<img src="/EngDev/Images94/QuickAccess/qa_calendar_button.jpg"  border=0 align="absmiddle">
						</a> &nbsp;
				  </td>
			
				  <td <!$MGIF_ApplyDeactive>colspan=4 <!$MGELSE> colspan=6<!$MGENDIF> align="right"><input type="button" id="RateLogic" name="RateLogic" value="|^Rate Logic^|" onclick="javascript:show_RateLogic_Zoom(event);" class="buttonMdTp3" >
				  <input type="button" id="Exit" name="Exit" value="|^Exit^|" onclick="javascript:window.close();" class="buttonMdTp3" ></td> 
			</tr>
			  
						<TR>
							  	<TD  colspan="6" class="NormalImgRightCorner"><span class="WindowHeader"> |^Rate Details^|</span>
										</TD>
						</TR>
            <td colspan="6">
			<div id='s3' style="overflow: auto;  height:30px; border-color:none; padding:0px; margin: 0px ;background-color:#ffffff;" >
				<table border="1" id=""   style="behavior:url(/EngDev/GenScripts94/tablehl.htc);background-color:#D2E4FC;" slcolor=#8297C4 hlcolor=#BEC5DE class="box"  width="100%">
		                   <THEAD>
							                    <TR valign="top" style="height:15px;" class='qAccessTableHdr'>
													<TH bgcolor="#dededc" style="width:20px;">&nbsp;#</TH>
													<TH bgcolor="#dededc" <!$MGIF_AllowSrNoLogic> style="width:45px;"<!$MGELSE>style="display:none" <!$MGENDIF> >|^Rate SR No^|</TH>
													<TH bgcolor="#dededc" style="width:80px;" >|^Car Group^|</TH>
							                     	<TH bgcolor="#dededc" align="center" style="width:<!$MG_THwidth>px;">|^Package^|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|^Days^|&nbsp;|^Hours^|<span id='Mins'
        style="display:none"> |^Minutes^|</span> </TH>
													<TH bgcolor="#dededc" style="width:100px;" >|^Period Price^|</TH>
													<TH bgcolor="#dededc" style="width:100px;" >|^Driver Extension^|</TH>
													<TH bgcolor="#dededc" style="width:100px;">|^Customer Extension^|</TH>
													<TH bgcolor="#dededc" style="width:100px;" >|^Km Allowance Per Package^|</TH>
													<TH bgcolor="#dededc" style="width:110px;">|^Ext Km Allowance Per Day^|</TH>
													<TH bgcolor="#dededc" style="width:100px;" >|^Drv Charge Per Km^|</TH>
													<TH bgcolor="#dededc" style="width:100px;" >|^Cust Charge Per Km^|</TH>
													<TH bgcolor="#dededc" style="width:80px;">|^Max Km to Charge^|</TH>
													<TH bgcolor="#dededc" style="width:100px;">|^Max Km to Charge Type^|</TH>
													<TH bgcolor="#dededc" style="width:37px;" align='left'> |^Del.^|</TH>
													<TH  style="width:12px; display:none" id='Scroll' > &nbsp;&nbsp;&nbsp;&nbsp;</TH>
							                     </TR>
												 </THEAD>
					 </table>
			 </div>
							
							<div id='s2' style="overflow: auto;  height: 300; border-color:none; padding:0px; margin: 0px ;background-color:#ffffff;" >
				<table border="1" id="DetailsTable"   style="behavior:url(/EngDev/GenScripts94/tablehl.htc);background-color:#D2E4FC;" slcolor=#8297C4 hlcolor=#BEC5DE class="box"  width="100%">
		                   
							                    <!--TR valign="top" style="height:15px;">
													<TH bgcolor="#dededc" >&nbsp;#</TH>								
							                        <TH bgcolor="#dededc" >|^Car Group^|</TH>
							                     	<TH bgcolor="#dededc" align="center">|^Package^|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|^Days^|&nbsp;|^Hours^|</TH>
													<TH bgcolor="#dededc" >|^Period Price^|</TH>
													<TH bgcolor="#dededc" >|^Driver Extension^|</TH>
													<TH bgcolor="#dededc" >|^Customer Extension^|</TH>
													<TH bgcolor="#dededc" >|^Km Allowance Per Package^|</TH>
													<TH bgcolor="#dededc" >|^Ext Km Allowance Per Day^|</TH>
													<TH bgcolor="#dededc" >|^Drv Charge Per Km^|</TH>
													<TH bgcolor="#dededc" >|^Cust Charge Per Km^|</TH>
													<TH bgcolor="#dededc" >|^Max Km to Charge^|</TH>
													<TH bgcolor="#dededc" >|^Max Km to Charge Type^|</TH>
													<TH bgcolor="#dededc"> |^Del.^| </TH>
													
							                     </TR-->
												 
												 <TR valign="top" >
													<TH  style="height:0px; display:none" ></TH>								
							                     </TR>
												 
							                   <!$MGIF_RecourdExists>
											   <!$MGREPEAT>
											   <tr id="Det<!$MG_RateCounter>">
											   <script language="JavaScript" type="text/javascript">
												attachTrOnClick(document.getElementById("Det<!$MG_RateCounter>"),'<!$MG_RateCounter>',document.getElementById("DetailsTable"));	   
												</script>
										
											   <td style="width:20px;"><!$MG_RateCounter></td>
											   <td <!$MGIF_AllowSrNoLogicView> style="width:45px;" <!$MGELSE>style="width:45px;display:none" <!$MGENDIF> >
											   <input class="readOnly_textInputField_AmtNr" type="text" name="RateSrNO<!$MG_RateCounter>" id="RateSrNO<!$MG_RateCounter>" value="<!$MG_RateSrNO>" readonly tabIndex=-1 onblur="">
											   </td>
											   
											   
											   <td style="width:80px;" >
											    <select name="Group<!$MG_RateCounter>" id="Group<!$MG_RateCounter>" class="textInputField_CmbLr" style="width:60px" onchange="SetSec2RowIdOnchange(document.getElementById('Group<!$MG_RateCounter>'),'<!$MG_RateCounter>',0,0);" > 
												<option value="<!$MG_Rate2_GroupCode>"><!$MG_Rate2_GroupDescr></option>
												</select>
												<script language="JavaScript" type="text/javascript">
												if(document.getElementById("CallFromCopy").value=="Y")
												{
												buildMethodcombo(document.getElementById("Group<!$MG_RateCounter>"),GroupCode_arr,GroupText_arr,'<!$MG_Rate2_GroupCode>');	
												//SetSec2RowId(textGr,lastRow,0,0);
												SetSec2RowId(this,<!$MG_RateCounter>,0,0);
												
												}
												if(document.getElementById("ClickMenuID").value=="C" || document.getElementById("CallFromCopy").value=="Y")
													document.getElementById("Group<!$MG_RateCounter>").disabled=false;
													else
													document.getElementById("Group<!$MG_RateCounter>").disabled=true;
												</script>
											   </td>
											   <td nowrap style="width:<!$MG_TDwidth>px;" >
											   <select name="Package<!$MG_RateCounter>"  id="Package<!$MG_RateCounter>" class="textInputField_CmbLr" style="width:120px" onchange="SetSec2RowIdOnchange(document.getElementById('Package<!$MG_RateCounter>'),'<!$MG_RateCounter>',0,0);"> 
											   <option value="<!$MG_Rate2_PackageCode>"><!$MG_PackDescr123></option>
												</select>
												<script language="JavaScript" type="text/javascript">
												if(document.getElementById("CallFromCopy").value=="Y")
												{
												buildMethodcombo(document.getElementById("Package<!$MG_RateCounter>"),PackageCode_arr,PackageText_arr,'<!$MG_Rate2_PackageCode>');	
												SetSec2RowId(this,<!$MG_RateCounter>,0,0);
												
												}
												if(document.getElementById("ClickMenuID").value=="C" || document.getElementById("CallFromCopy").value=="Y")
													document.getElementById("Package<!$MG_RateCounter>").disabled=false;
													else
													document.getElementById("Package<!$MG_RateCounter>").disabled=true;
												</script>
											  	
					<input class="readOnly_textInputField_AmtNr" type="text" name="Days<!$MG_RateCounter>" id="Days<!$MG_RateCounter>" value="<!$MG_Rate2_Days>" readonly tabIndex=-1>
													
				<input class="readOnly_textInputField_AmtNr" type="text" name="Hours<!$MG_RateCounter>" id="Hours<!$MG_RateCounter>" value="<!$MG_Rate2_Hours>" readonly tabIndex=-1>
				<input class="readOnly_textInputField_AmtNr" type="text"  style="display:none" name="Min<!$MG_RateCounter>" id="Min<!$MG_RateCounter>" value="<!$MG_Rate2_Min>" readonly tabIndex=-1>
												<script language="JavaScript" type="text/javascript">
												if(document.getElementById("CallFromCopy").value=="Y")
												{
												SetSec2RowId(document.getElementById("Package<!$MG_RateCounter>"),<!$MG_RateCounter>,0,0,document.getElementById("Package<!$MG_RateCounter>"),document.getElementById("Days<!$MG_RateCounter>"),document.getElementById("Hours<!$MG_RateCounter>"));
												}
												
												</script>
												</td>
												<td style="width:100px;" >	
				<input class="textinputfieldMd" type="text" name="Price<!$MG_RateCounter>" id="Price<!$MG_RateCounter>" value="<!$MG_Rate2_Price>" onkeypress="return(CheckFloatKey(event))" onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="if(CompanyFormat.value =='120'){ SetSec2RowIdOnchange(document.getElementById('Price<!$MG_RateCounter>'),'<!$MG_RateCounter>',14,document.getElementById('DecimalFormat').value)} else{ SetSec2RowIdOnchange(document.getElementById('Price<!$MG_RateCounter>'),'<!$MG_RateCounter>',10,document.getElementById('DecimalFormat').value)}">
				</td>
				
				<td style="width:100px;">	
				<input class="textinputfieldMd" type="text" name="DrvExtPrice<!$MG_RateCounter>" id="DrvExtPrice<!$MG_RateCounter>" value="<!$MG_Rate2_DrvExtPrice>" onkeypress="return(CheckFloatKey(event))" maxlength=20 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="if(CompanyFormat.value =='120'){SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',14,document.getElementById('DecimalFormat').value)} else{SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',6,document.getElementById('DecimalFormat').value)}">
				</td>
				
				<td style="width:100px;">	
				<input class="textinputfieldMd" type="text" name="CustExtPrice<!$MG_RateCounter>" id="CustExtPrice<!$MG_RateCounter>" value="<!$MG_Rate2_CustExtPrice>" onkeypress="return(CheckFloatKey(event))" maxlength=20 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="if(CompanyFormat.value =='120'){SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',14,document.getElementById('DecimalFormat').value)} else{SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',6,document.getElementById('DecimalFormat').value)}">
				</td>
				<td style="width:100px;">	
				<input class="textinputfieldMd" type="text" name="KMAllwPerPack<!$MG_RateCounter>" id="KMAllwPerPack<!$MG_RateCounter>" value="<!$MG_Rate2_KMAllwPerPack>" onkeypress="return(CheckFloatKey(event))" maxlength=6 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="CalculateExtAllwPerDay(this,'<!$MG_RateCounter>');SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',10,document.getElementById('DecimalFormat').value);">
				</td>
				<td style="width:110px;">	
				<input class="textinputfieldMd" type="text" name="ExtAllwPerDay<!$MG_RateCounter>" id="ExtAllwPerDay<!$MG_RateCounter>" value="<!$MG_Rate2_ExtAllwPerDay>" onkeypress="return(CheckFloatKey(event))" maxlength=5 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',10,document.getElementById('DecimalFormat').value)">
				</td>
				
				<td style="width:100px;">	
				<input class="textinputfieldMd" type="text" name="DrvChargePerKm<!$MG_RateCounter>" id="DrvChargePerKm<!$MG_RateCounter>" value="<!$MG_Rate2_DrvChargePerKm>" onkeypress="return(CheckFloatKey(event))" maxlength=20 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="if(CompanyFormat.value =='120'){SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',14,document.getElementById('DecimalFormat').value)} else{SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',10,document.getElementById('DecimalFormat').value)} ">
				</td>
				<td style="width:100px;">	
				<input class="textinputfieldMd" type="text" name="CustChargePerKm<!$MG_RateCounter>" id="CustChargePerKm<!$MG_RateCounter>" value="<!$MG_Rate2_CustChargePerKm>" onkeypress="return(CheckFloatKey(event))" maxlength=20 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="if(CompanyFormat.value =='120'){SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',14,document.getElementById('DecimalFormat').value)} else{SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',10,document.getElementById('DecimalFormat').value)}">
				</td>
				<td style="width:80px;">	
				<input class="textinputfieldMd" type="text" name="MaxKmToCharge<!$MG_RateCounter>" id="MaxKmToCharge<!$MG_RateCounter>" value="<!$MG_Rate2_MaxKmToCharge>" onkeypress="return(CheckFloatKey(event))" maxlength=8 onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',8,document.getElementById('DecimalFormat').value)">
				</td>
				<td style="width:100px;">
											   <select name="MaxKmToChargeType<!$MG_RateCounter>" id="MaxKmToChargeType<!$MG_RateCounter>" class="textInputField_CmbLr" onblur="SetSec2RowIdOnBlur(this,'<!$MG_RateCounter>')" onchange="SetSec2RowIdOnchange(this,'<!$MG_RateCounter>',0,0)"> 
											   <option value="1">|^Per Agreement^|</option>
												<option value="2">|^Per Day^|</option>	
												</select>
												<script language="JavaScript" type="text/javascript">
												document.getElementById("MaxKmToChargeType<!$MG_RateCounter>").value='<!$MG_Rate2_MaxKmToChargeType>'
												</script>
											   </td>
												<td style="width:37px;">	
				<input <!$MGIF_ModeView> style="display:None" <!$MGENDIF>  type="button" name="DelDelete<!$MG_RateCounter>" id="DelDelete<!$MG_RateCounter>" value="..." onclick="DeleteRow('Det<!$MG_RateCounter>','DetailsTable','<!$MG_RateCounter>',document.getElementById('ClickMenuID').value);">
				</td>
											   </tr>
											   <!$MGENDREPEAT>
											   <!$MGENDIF>
																	
							                    
																	
							                </table>
															</div>
															</tr>
															<tr>
															<td align="left" colspan="6">
														        <input type="button" id="AddSec2" name="AddSec2" value="|^Add^|" onclick="javascript:Save_AddInsInfo();" class="buttonMdTp3" >
														    </td></tr>
				
														<tr id='Approval' style="display:none;">
														<td colspan=4>
			  <table width="100%" cellpadding="2" border="1" cellspacing="2"  class="box">
        
			 <tr>
            <td>|^Approval Date^|</td >
            <td>	
      <input class="textInputFieldMd" type="text" name="apprDateMMDDYYYY" id="apprDateMMDDYYYY" value="<!$MG_apprDateMMDDYYYY>" onchange="if(this.value!=''){isDate(this,2);}" size=8 maxlength="10" style="width:80px;" onblur="if(this.value!=''){DateInFuture(this, 2);} ; changeDatetoDDMMYYYY(this,'apprDate'); ">
      
      <a  name="C1" id="C1" href="javascript:var cal1 = new calendar(document.forms[0].apprDateMMDDYYYY,2);cal1.past_future='';cal1.popup();var d= DateInFuture(document.forms[0].apprDateMMDDYYYY,2);">
      <img id='img1'name="img1" src="/EngDev/Images94/QuickAccess/qa_calendar_button.jpg"  border=0 align="absmiddle" ></a>
      <input class="textInputFieldMd" type="hidden" id="apprDate" name="apprDate" value="<!$MG_ApprovalDate>" onblur="if(this.value!=''){isDate(this);var d =DateInFuture(document.forms[0].apprDate);}" style="width:76px;" maxlength="10">
            </td>
        </tr>		 
        <tr>
            <td>|^Status^|</td>
            <td id="cmbStatus">
                <select name="status1" id="status1" class="textInputField_CmbMd" style="width:100px;"> <!-- onchange="statusAR();"-->
                <!--option value="">&nbsp;</option-->
               <!-- <option value="0">|^Pending^|</option> -->
                <option value="1">|^Approved^|</option>
                <option value="3">|^Rejected^|</option>																	
                </select>
            </td>
            <td id="txtStatus">
            <!--<input type="text" name="status1" id="status1" value="<!$MG_ApprStatus>" class="readOnly_textInputFieldMd" readonly maxlength="20" style="width:100px;">-->
            </td>
        </tr>
        <tr id="rmkROW">
            <td>|^Remarks^|</td>
            <td><textarea name="remarks" id="remarks" class="textInputFieldLr" rows="3" cols="80" style="width:400" maxlength="100"><!$MGIF_ModeNotX><!$MG_Remarks><!$MGELSE><!$MG_ApprRmks><!$MGENDIF></textarea></td>
        </tr>	
        </table>
			</td>
			</tr>
			</tr>
							</table>
							
        </tr>
			
        <tr>
            <td>
            <table  width="100%" border=0 class="box">
            <tr>
				<td id="history" style="display:none;"><INPUT TYPE="button" class="buttonMdTp3"  id="Hist_BT" name="Hist_BT"  style="width:150" value="|^Approval History^|" onclick="History()"></td>
                <td align="right">
				<INPUT type="button" style="display:None" class="buttonMdTp3" id="RateLog" name="RateLog" value="|^Rate Log^|"  onclick="RateLog111();">
				
				<INPUT type="button" class="buttonMdTp3" id="CopyGr_BT" name="CopyGr_BT" value="|^Copy Group^|"  onclick="show_CopyGroup_Zoom(event)">
				<INPUT type="button" class="buttonMdTp3" id="FFMileage_BT"  name="FFMileage_BT" value="|^Airline Info^|" onclick="show_FFMileage_Zoom(event)">
				<INPUT type="button" class="buttonMdTp3" id="Billing_BT"  name="Billing_BT" value="|^Billing^|" onclick="show_Billing_Zoom(event)">
				<INPUT type="button" class="buttonMdTp3" id="Insur_BT" name="Insur_BT" value="|^Insurances^|" onclick="show_Insu_Zoom(event)">
				<INPUT type="button" class="buttonMdTp3" id="Extras_BT" name="Extras_BT" value="|^Extras^|" onclick="show_Extras_Zoom(event)">
				<INPUT type="button" class="buttonMdTp3" id="Suppli_BT" name="Suppli_BT" style="width:100px" value="|^Supplements^|" onclick="show_Suppli_Zoom(event)">
				<INPUT TYPE="button" class="buttonMdTp3"  id="Proceed_BT" name="Proceed_BT" value="|^Proceed^|" onclick="check_form()">
				<input type="button" id="DeleteBtn" name="DeleteBtn" value="|^Delete^|" onclick="DeleteRec();" class="buttonMdtp3"/>
                </td>
            </tr>
            </table>
            </td>
        </tr>
        </table>
        </td>
    </tr>
    </table>
    </td>
    <td valign="top" class="RightBorder"><!--DWLayoutEmptyCell-->&nbsp;</td>							
</TR>
<tr>
    <td valign="top" class="BottomLeftCorner"></td>
    <td valign="top" class="BottomBorder"><!--DWLayoutEmptyCell--></td>
    <td valign="top" class="BottomRightCorner"></td>      
 </tr>
</table>
<div id="Zoom_KmDetail_Win" class="xstooltip"  style="overflow: auto;    height: 396; width: 500;">
<table class="box" width="490">
<col width="35%">
<col width="15%">
<col width="30%">
<col width="20%">
<tr>
   <td align="left" ><span id="PackOpt">|^Advance Reservation Days^|</span></td>
   <td align="left" ><INPUT TYPE="text"  name="AdvanceReservationDays"  id="AdvanceReservationDays" onchange="UpdateRateLogicXml();" maxlength=3 onkeypress="return(CheckIntegerKey(event))"style="width:30px" class="textInputField_AmtLr" value=""/>
   To
   <INPUT TYPE="text"  name="AdvanceReservationDaysTo"  id="AdvanceReservationDaysTo" onchange="UpdateRateLogicXml();" maxlength=3 onkeypress="return(CheckIntegerKey(event))"style="width:30px" class="textInputField_AmtLr" value=""/>
   </td>
   <td align="left">|^Through Other Country^|</td>
   <td align="right" ><select name="ThroughOtherCountry" id="ThroughOtherCountry" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option  value = "N">|^No^|</option>
					</select></td>
</tr>
<tr>
   <td align="left"><span id="PackOpt">|^Flight Information^|</span></td>
   <td align="right" ><select name="FlightInformation" id="FlightInformation" style="width:80px"  onchange="UpdateRateLogicXml();FlightInfo();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
						</select></td>
   <td align="left" id="FixedExgRateLblId">|^Fixed Exchange Rate^|</td>
   <td align="right" id="FixedExgRateFldId" ><select name="FixedExchangeRate" id="FixedExchangeRate" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
					</select></td>
</tr>
<tr>
   <td align="left">|^Cancellable^|</td>
   <td align="right" ><select name="Cancellable" id="Cancellable" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option value = "N">|^No^|</option>
					</select></td>
					 <td align="left">|^Optimize Above^|</td>
   <td align="right" ><select name="OptimizeAbove" id="OptimizeAbove" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option value = "N">|^No^|</option>
					</select></td>
</tr>
<tr>
   <td align="left">|^Discountable^|</td>
   <td align="right" ><select name="Discountable" id="Discountable" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option value = "N">|^No^|</option>
					</select></td>
 <td align="left">|^Country Required^|</td>
   <td align="right" ><select name="CountryRequired" id="CountryRequired" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
						</select></td>					
</tr>
<tr>
   <td align="left">|^Max Discount %^|</td>
   <td align="right" ><INPUT TYPE="text"  name="MaxDiscountPerc"  id="MaxDiscountPerc" maxlength=6 onchange="CheckPercent(this);UpdateRateLogicXml();" onkeypress="return(CheckFloatKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>
   <td align="left">|^Country Exception^|</td>
   <td align="right" ><select name="CountryException" id="CountryException" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
						</select></td>
</tr>
<tr>
   <td align="left">|^Charge Fuel Tank^|</td>
   <td align="right" ><select name="ChargeFuelTank" id="ChargeFuelTank" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
					</select></td>
<td align="left">|^Charge DropOff Fee^|</td>
   <td align="right" ><select name="ChargeDropOffFee" id="ChargeDropOffFee" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option value = "N">|^No^|</option>
					</select></td>					
</tr>

<tr>
   <td align="left">|^Charge Airport Fee^|</td>
   <td align="right" ><select name="ChargeAirportFee" id="ChargeAirportFee" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "Y">|^Yes^|</option>
						<option value = "N">|^No^|</option>
					</select></td>
<td align="left">|^<!$MGIF_Comp144>Down Days<!$MGELSE>Religious Agreement<!$MGENDIF>^|</td>
   <td align="right" ><select name="ReligiousAgreement" id="ReligiousAgreement" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
						</select></td>					
</tr>
<tr>
   <td align="left">|^Customer Extension Discount^|</td>
   <td align="right" ><select name="CustomerExtensionDiscount" id="CustomerExtensionDiscount" style="width:80px"  onchange="UpdateRateLogicXml();CustDisOnCHange();" class="textInputField_CmbMD">
						<option value = "N">|^No^|</option>
						<option value = "Y">|^Yes^|</option>
					</select></td>
 <td align="left">|^Customer Ext Discount %^|</td>
   <td align="right" ><INPUT TYPE="text"  name="CustExtDiscountPerc"  id="CustExtDiscountPerc" maxlength=6 onchange="CheckPercent(this);UpdateRateLogicXml();" onkeypress="return(CheckFloatKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>					
</tr>
<tr id="CustomerDaysLogicId">
 <td align="left">|^No Of Days^|</td>
   <td align="right" ><INPUT TYPE="text"  name="NOofDays"  id="NOofDays" maxlength=4 onchange="UpdateRateLogicXml();" onkeypress="return(CheckIntegerKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>
 <td align="left">|^No Of Free Days^|</td>
   <td align="right" ><INPUT TYPE="text"  name="FreeDays"  id="FreeDays" maxlength=4 onchange="UpdateRateLogicXml();" onkeypress="return(CheckIntegerKey(event))" style="width:80px" class="textInputField_AmtLr" value=""/></td>					
</tr>
<tr id="WorkHourLogicId" style="display:none">
 <td align="left">|^After Hours Flat Amount^|</td>
   <td align="right" ><INPUT TYPE="text"  name="AHFAmount"  id="AHFAmount" maxlength=6 onchange="checkAmountAndPercent('AHFAmount','AHCPer');UpdateRateLogicXml();" onkeypress="return(CheckIntegerKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>
 <td align="left">|^After Hours Charge %^|</td>
   <td align="right" ><INPUT TYPE="text"  name="AHCPer"  id="AHCPer" maxlength=6 onchange="checkAmountAndPercent('AHFAmount','AHCPer');CheckPercent(this);UpdateRateLogicXml();" onkeypress="return(CheckFloatKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>						
</tr>
<tr>
 <td align="left">|^Rounding^|</td>
   <td align="right" ><INPUT TYPE="text"  name="Rounding"  id="Rounding" maxlength=6 onchange="UpdateRateLogicXml();" onkeypress="return(CheckIntegerKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>
    <td align="left" style="display:none" id="OptPkg1">|^Optimize Package^|</td>
   <td align="right" style="display:none" id="OptPkg2">
		<select name="OptimizePackage" id="OptimizePackage" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
			<option value = "Y">Yes</option>
			<option value = "N">No</option>
		</select>
	</td>

</tr>
<tr id="SalesMan_158">
 
 <td align="left">|^User ID^|</td>
   <td  nowrap> 
                <input class="textInputField_AmtLr" type="text"name="SalesMan" id="SalesMan" readonly onchange="UpdateRateLogicXml();" style="text-transform:uppercase;" size="6" maxlength="10" style="width:65px" onblur="UpdateRateLogicXml();">
                <img src="/EngDev/Images94/QuickAccess/qa_search_button.jpg" width="20" height="20" align="absmiddle" onclick="NewWin('/Magic94Scripts/mgrqispi94.dll?appname=RentProWeb&prgName=EmployeeInformation&Arguments=-A1,-A,-A,-A,-A,-A1,-A,-A,-A','ChfQuotationQa','ChfQuotationQa','left=160,top=70,height=525,WIDTH=865,scrollbars=1,resizable=1');">
              
							</td>
   <!-- <td align="right" ><INPUT TYPE="text"  name="SalesMan"  id="SalesMan" maxlength=6  readOnly onkeypress="return(CheckFloatKey(event))"style="width:80px" class="textInputField_AmtLr" value=""/></td>						 -->
</tr>

<tr id="ShowOptimizeByDay" style="display:none">
 <td align="left">Optimize By Day</td>
   <td align="right" >
		<select name="OptimizeByDay" id="OptimizeByDay" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
			<option value = "Y">Yes</option>
			<option value = "N">No</option>
		</select>
	</td>
</tr>
<tr id="ShowOMonthlyRental" style="display:none">
 <td align="left">Monthly Rental</td>
   <td align="left" colspan="3">
		<select name="MonthlyRental" id="MonthlyRental" style="width:80px"  onchange="UpdateRateLogicXml();" class="textInputField_CmbMD">
			<option value = "N">No</option>
			<option value = "Y">Yes</option>
		</select>
	</td>
</tr>
<tr id="ShowBranchTr" style="display:none">
   <td align="left" valign="top"><b>|^Out Branch^|</b></td><td><select name="CheckOutBranch" multiple id="CheckOutBranch" style="width:140px;height:150px" onchange="" class="textInputField_CmbMD">
   <option value ="" selected >|^All^|</option><!$MG_OutBranchCombo></select></td><td valign="top"><b>|^In Branch^|</b></td><td>
   <select name="CheckInBranch" multiple id="CheckInBranch" style="width:140px;height:150px" onchange="" class="textInputField_CmbMD"><option value ="" selected >|^All^|</option>
   <!$MG_OutBranchCombo></select>
   </td>
</tr>

<tr id="PaymentRow" style="display:none">
	<td colspan=4>
	<table>
	<tr><td><input type="button" id="AddPay" name="AddPay" value="|^Add^|" onclick="javascript:CreatePaymentXmlNode();" class="buttonMdTp3" ></td></tr>
	<tr><td>
		<table class="box" width="250" id="PaymentTable">
			<col width="10%">
			<col width="50%">
			<col width="40%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Payment Method^|</td>
			   <th align="right" >|^Type^|</td>
			</tr>
			
		</table></tr></td>
	</table>	
	</td>		
</tr>
<tr id="TourOperatorRow" style="display:none">
	<td colspan=4>
	<table>
	<tr><td><input type="button" id="AddTour" name="AddTour" value="|^Add^|" onclick="javascript:CreateTourXmlNode();" class="buttonMdTp3" ></td></tr>
	<tr><td>
		<table class="box" width="250" id="TourTable">
			<col width="10%">
			<col width="50%">
			<col width="40%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Operator ID^|</td>
			   <th></td>
			</tr>
			
		</table></tr></td>
	</table>	
	</td>		
</tr>
<tr id="FlightInformationRow" style="display:none">
	<td colspan=4>
	<table>
	<tr><td><input type="button" id="AddFlight" name="AddFlight" value="|^Add^|" onclick="javascript:CreateFlightXmlNode();" class="buttonMdTp3" ></td></tr>
	<tr><td>
		<table class="box" width="250" id="FlightTable">
			<col width="10%">
			<col width="50%">
			<col width="40%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Airlines^|</td>
			   <th></td>
			</tr>
			
		</table></tr></td>
	</table>	
	</td>		
</tr>
<tr id="CountReqRow" style="display:none">
	<td colspan=4>
	<table>
	<tr><td><input type="button" id="AddReq" name="AddReq" value="|^Add^|" onclick="javascript:CreateCountReqXmlNode();" class="buttonMdTp3" ></td></tr>
	<tr><td>
		<table class="box" width="250" id="CountReqTable">
			<col width="10%">
			<col width="50%">
			<col width="40%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Country^|</td>
			</tr>
		</table></tr></td>
	</table>	
	</td>		
</tr>

<tr id="CountExcRow" style="display:none">
	<td colspan=4>
	<table>
	<tr><td><input type="button" id="AddExc" name="AddExc" value="|^Add^|" onclick="javascript:CreateCountExcXmlNode();" class="buttonMdTp3" ></td></tr>
	<tr><td>
		<table class="box" width="250" id="CountExcTable">
			<col width="10%">
			<col width="50%">
			<col width="40%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Country^|</td>
			</tr>
			
		</table></tr></td>
	</table>	
	</td>		
</tr>

<tr><td align="right" colspan=4>
<input type="button" id="OutBrBtn" name="OutBrBtn" style="width:120px;" value="|^Out Branch^|" onclick="javascript:ToggleOutBrRow('ShowBranchTr');" class="buttonMdTp3" >
<input type="button" id="InBrBtn" name="InBrBtn" style="width:120px;" value="|^In Branch^|" onclick="javascript:ToggleOutBrRow('ShowBranchTr');" class="buttonMdTp3" >
<input type="button" id="PaymentBtn" name="PaymentBtn" style="width:120px;" value="|^Payment Requirement^|" onclick="javascript:ToggleOutBrRow('PaymentRow');" class="buttonMdTp3" >
<input type="button" id="CountryReq" name="CountryReq" style="width:120px;" value="|^Country Required^|" onclick="javascript:ToggleOutBrRow('CountReqRow');" class="buttonMdTp3" >
<input type="button" id="CountryExc" name="CountryExc" style="width:120px;" value="|^Country Exception^|" onclick="javascript:ToggleOutBrRow('CountExcRow');" class="buttonMdTp3" >
<input type="button" id="SuppliLogic" name="SuppliLogic" style="display:none" value="|^Supplement Logic^|" onclick="javascript:show_SuppliLogic_Zoom();" class="buttonMdTp3" >
<input type="button" id="TourBtn" name="TourBtn" value="|^Tour Operator^|" style="width:120px;" onclick="javascript:ToggleOutBrRow('TourOperatorRow');" class="buttonMdTp3" >
<input type="button" id="FlightBtn" name="FlightBtn" value="|^Flight Information^|" style="width:120px;" onclick="javascript:ToggleOutBrRow('FlightInformationRow');" class="buttonMdTp3" >
</td></tr>
<tr><td align="right" colspan=4><input type="button" id="RateLogicProceed" name="RateLogicProceed" value="|^Proceed^|" onclick="javascript:CallRateLogicProceed();" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_KmDetail_Win');" class="buttonMdTp3" ></td></tr>
</table>
</div> 

<div id="Zoom_Extras_Win" class="xstooltip"  >
<table class="box" width="250">
<col width="100%">
<tr><td><input type="button" id="AddExt" name="AddExt" value="|^Add^|" onclick="javascript:CreateExtrasXmlNode();" class="buttonMdTp3" >
	<b>&nbsp;&nbsp;&nbsp;Group:&nbsp;<span id="ExtrasGroup"></span>&nbsp;&nbsp;&nbsp;Package:&nbsp;<span id="ExtrasPkg"></span></b>
</td></tr>
<tr>
   <td><table class="box" width="250" id="ExtrasTable" style="behavior:url(/EngDev/GenScripts94/tablehl.htc);background-color:#D2E4FC;" slcolor=#8297C4 hlcolor=#BEC5DE class="box"  width="100%">
			<col width="5%">
			<col width="35%">
			<col width="20%">
			<col width="40%">
			<col width="5%">
			<tr>
			<th align="left">|^#^|</td>
			   <th align="left">|^Extras^|</th>
			   <th align="right" >|^Included^|</th>
			   <th align="right" >|^Price^|</th>
			   <th align="left"></td>
			</tr>
			<tbody id="ExtrasTabelBody">
			</tbody>
		</table></td>
</tr>
<tr><td align="right" colspan=2><input type="button" id="ExtrCopy" disabled name="ExtrCopy" value="|^Copy Extras^|" onclick="javascript:enableDisableExtra();" class="buttonMdTp3" style="width:90px" /><input type="button" id="SplitProceed" name="SplitProceed" value="|^Save^|" onclick="javascript:HideToolTipWindow('Zoom_Extras_Win');" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_Extras_Win');" class="buttonMdTp3" ></td></tr>
</table>
<table class="box" style="display:none" id="copyExtra" width="25%" >
<col width="100%">
<tr>
							<td nowrap>|^Copy to all Groups^|</td>
							<td><select name="AllGroupsExtr" id="AllGroupsExtr" style="" onchange="enableCargrpExtra();" class="textInputField_CmbLG">
								<OPTION value="Y">|^Yes^|</OPTION>
								<OPTION value="N">|^No^|</OPTION>
							</select></td>
						</tr>						
						<tr>
							<td nowrap>|^Specific Group^|</td>
							<td><input type="text" name="SpecGrpExtra" id="SpecGrpExtra" maxlength="5" value="" class="textInputFieldMD" READONLY />
							 <input  type="button" value=".." id="carGrpBtnExtra" name="carGrpBtnExtra" onclick="openCarGroupZWin('E');" onchange="openCarGroupZWin('E');" class="zbutton"    ></td>
						</tr>
						<tr>
							<td colspan=2><input type="button" id="CopyExtrProceed" name="CopyExtrProceed" value="|^Save^|" onclick="javascript:SaveCopyExtra();" class="buttonMdTp3" />
							</td>
						</tr>
</table>
</div>
<div id="Zoom_Insu_Win" class="xstooltip" style="height:100px" >
<table class="box" width="250">
<col width="100%">
<tr><td><input type="button" id="AddInsu" name="AddInsu" value="|^Add^|" onclick="javascript:CreateInsuXmlNode();" class="buttonMdTp3" >
	<b>&nbsp;&nbsp;&nbsp;GROUP:&nbsp;<span id="InsuGroup"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACKAGE:&nbsp;<span id="InsuPkg"></span></b>
</td></tr>
<tr>
   <td><table class="box" width="250" id="InsuTable"  style="behavior:url(/EngDev/GenScripts94/tablehl.htc);background-color:#D2E4FC;" slcolor=#8297C4 hlcolor=#BEC5DE class="box"  width="100%">
			<col width="40%">
			<col width="20%">
			<col width="40%">
			<tr>
			<thead>
			<th align="left">|^#^|</td>
			   <th align="left">|^Insurance^|</th>
			   <th align="right" >|^Included^|</th>
			   <th align="right" >|^Price^|</th>
			   <th align="right" >|^Max. Charge^|</th>
			   <th align="right" >|^Min. Charge^|</th>
			   <th align="right" >|^Driver Ext^|</th>
			   <th align="right" >|^Cust. Ext^|</th>
			   <th align="right" >|^Deduct^|</th>
			   <th align="right" >|^N.W.Deduct^|</th>
			   <th align="right" >|^Supplement For Young Driver^|</th>
			   <th align="right" >|^Supplement Deductible For Young Driver^|</th>
			   <th align="right" ></th>
			</tr>
			</thead>
			<tbody id="InsuTabelBody">
			</tbody>
		</table></td>
</tr>
<tr><td align="right" colspan=2><input type="button" id="insuCopy" disabled name="insuCopy" value="|^Copy Insurance^|" onclick="javascript:enableDisable();" class="buttonMdTp3" style="width:90px" /><input type="button" id="InsuProceed" name="InsuProceed" value="|^Save^|" onclick="javascript:HideToolTipWindow('Zoom_Insu_Win');" class="buttonMdTp3" /><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_Insu_Win');" class="buttonMdTp3" /></td></tr>
</table>
<table class="box" style="display:none" id="copyInsu" width="25%" >
<col width="100%">
<tr>
							<td nowrap>|^Copy to all Groups^|</td>
							<td><select name="AllGroups" id="AllGroups" style="" onchange="enableCargrp();" class="textInputField_CmbLG">
								<OPTION value="Y">|^Yes^|</OPTION>
								<OPTION value="N">|^No^|</OPTION>
							</select></td>
						</tr>						
						<tr>
							<td nowrap>|^Specific Group^|</td>
							<td><input type="text" name="SpecGrp" id="SpecGrp" maxlength="5" value="" class="textInputFieldMD" READONLY />
							 <input  type="button" value=".." id="carGrpBtn" name="carGrpBtn" onclick="openCarGroupZWin();" onchange="openCarGroupZWin();" class="zbutton"    ></td>
						</tr>
						<tr>
							<td colspan=2><input type="button" id="CopyInsuProceed" name="CopyInsuProceed" value="|^Save^|" onclick="javascript:SaveCopyInsu();" class="buttonMdTp3" />
							</td>
						</tr>
</table>
</div>
<div id="Zoom_Suppli_Win" class="xstooltip"  >
<table class="box" width="300">
<col width="100%">
<tr><td><input type="button" id="AddSup" name="AddSup" value="|^Add^|" onclick="javascript:CreateSuppliXmlNode();" class="buttonMdTp3" >
<b>&nbsp;&nbsp;&nbsp;|^GROUP:^|&nbsp;<span id="SuppliGroup"></span></b>
</td></tr>
<tr>
   <td><table class="box" width="100%" id="SuppliTable">
			<col width="5%">
			<col width="30%">
			<col width="30%">
			<col width="30%">
			<col width="5%">
			<tr>
			    <th align="left">|^#^|</th>
			   <th align="left">|^From Date^|</th>
			   <th align="right" >|^To Date^|</th>
			   <th align="right" >|^Addition Per Day^|</th>
			   <th align="left"></th>
			</tr>
			<tbody id="SuppliTabelBody">
			</tbody>
		</table></td>
</tr>
<tr><td align="right"><input type="button" id="SUppliProceed" name="SUppliProceed" value="|^Save^|" onclick="javascript:HideToolTipWindow('Zoom_Suppli_Win');" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_Suppli_Win');" class="buttonMdTp3" ></td></tr>
</table>
</div>
<div id="Zoom_Billing_Win" class="xstooltip"  >
<table class="box" width="250">
<col width="100%">
<tr><td><input type="button" id="BillAdd" name="BillAdd" value="|^Add^|" onclick="javascript:CreateBillingXmlNode(0,0,0);" class="buttonMdTp3" >
	<b>&nbsp;&nbsp;&nbsp;Group:&nbsp;<span id="BilGrp"></span>&nbsp;&nbsp;&nbsp;|^Package:^|&nbsp;<span id="BilPck"></span></b>
</td></tr>
<tr>
   <td><table class="box" width="100%" id="BillingTable">
			<col width="5%">
			<col width="45%">
			<col width="45%">
			<col width="5%">
			<tr>
				<th align="left">|^#^|</th>
				<th align="left">|^Month^|</th>
				<th align="right" >|^Billing Amount^|</th>
				<th align="left">&nbsp;</th>
			</tr>
			<tbody>
			</tbody>
		</table></td>
</tr>
<tr><td align="right" colspan=2><input type="button" id="BillingProceed" name="BillingProceed" value="|^Save^|" onclick="javascript:ValidateBillingAmount()" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:ValidateBillingAmount1();" class="buttonMdTp3" ></td></tr>
</table>
</div>
<div id="Zoom_CopyGroup_Win" class="xstooltip"  >
<table class="box" width="250">
<col width="100%">
<tr>
   <td><table class="box" width="100%" id="BillingTable">
			<col width="50%">
			<col width="50%">
			<tr> <td align="left">|^From Group^|</td><td>
					<input type="text" name="CopyFromGroup" id="CopyFromGroup" style="width:80px;border:0px"  tabindex=-1 readonly  class="textInputField_CmbMD">
					</select></td></tr><tr>
			<tr> <td align="left">|^To Group^|</td><td>
					<select name="CopyToGroup" id="CopyToGroup" style="width:80px"  onchange="ValidatCarGroup();" class="textInputField_CmbMD">
					</select></td></tr><tr>		
			   <td align="left" >|^Change By %^|</td><td>
			   <INPUT TYPE="text"  name="ChangeByPercent"  id="ChangeByPercent" style="width:80px" class="textInputField_AmtLr" value="" onchange="CheckPercent(this);" onkeypress="return CheckFloatKey(event);"/>
			   </td>
			</tr>
			<tbody>
			</tbody>
		</table></td>
</tr>
<tr><td align="right" colspan=2><input type="button" id="CopyProceed" name="CopyProceed" value="|^Save^|" onclick="javascript:CopyCarGroup();" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_CopyGroup_Win');" class="buttonMdTp3" ></td></tr>
</table>
</div>
<div id="Zoom_FFMileage_Win" class="xstooltip"  >
<table class="box" width="250">
<col width="100%">
<tr><td><input type="button" id="FFMAdd" name="FFMAdd" value="|^Add^|" onclick="javascript:CreateFFMXmlNode();" class="buttonMdTp3" ></td></tr>
<tr>
   <td><table class="box" width="100%" id="FFMTable">
			<col width="5%">
			<col width="40%">
			<col width="30%">
			<col width="25%">
			<tr>
			<th align="left">|^#^|</th>
			   <th align="left">|^Program^|</th>
			   <th align="right" >|^P.Miles^|</th>
			   <th align="right" >|^Ext.Miles^|</th>			   
			</tr>
			<tbody>
			</tbody>
		</table></td>
</tr>
<tr><td align="right" colspan=2><input type="button" id="FFMileageProceed" name="FFMileageProceed" value="|^Save^|" onclick="javascript:HideToolTipWindow('Zoom_FFMileage_Win');" class="buttonMdTp3" ><input type="button" id="Close" name="Close" value="|^Close^|" onclick="javascript:HideToolTipWindow('Zoom_FFMileage_Win');" class="buttonMdTp3" ></td></tr>
</table>
</div>
</form>
<IFRAME src="" name="frm_page" id="frm_page" width="0" height="100" marginwidth="300" marginheight="0" scrolling="no" frameborder="2"></IFRAME>
</body>
</html>